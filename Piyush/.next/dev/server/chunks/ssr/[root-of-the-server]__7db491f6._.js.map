{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/piyushraj/Desktop/CyberShieldX/Piyush/src/components/ui/AnimatedText.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useRef, useState } from 'react';\n\ninterface AnimatedTextProps {\n    text: string;\n    className?: string;\n    delay?: number;\n    speed?: number;\n}\n\nexport default function AnimatedText({\n    text,\n    className = '',\n    delay = 0,\n    speed = 50\n}: AnimatedTextProps) {\n    const [displayedText, setDisplayedText] = useState('');\n    const [isVisible, setIsVisible] = useState(false);\n    const elementRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n        const observer = new IntersectionObserver(\n            ([entry]) => {\n                if (entry.isIntersecting && !isVisible) {\n                    setIsVisible(true);\n                }\n            },\n            { threshold: 0.1 }\n        );\n\n        if (elementRef.current) {\n            observer.observe(elementRef.current);\n        }\n\n        return () => observer.disconnect();\n    }, [isVisible]);\n\n    useEffect(() => {\n        if (!isVisible) return;\n\n        const timeout = setTimeout(() => {\n            let currentIndex = 0;\n            const interval = setInterval(() => {\n                if (currentIndex <= text.length) {\n                    setDisplayedText(text.slice(0, currentIndex));\n                    currentIndex++;\n                } else {\n                    clearInterval(interval);\n                }\n            }, speed);\n\n            return () => clearInterval(interval);\n        }, delay);\n\n        return () => clearTimeout(timeout);\n    }, [isVisible, text, delay, speed]);\n\n    return (\n        <div ref={elementRef} className={className}>\n            {displayedText}\n            <span className=\"animate-pulse\">|</span>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAWe,SAAS,aAAa,EACjC,IAAI,EACJ,YAAY,EAAE,EACd,QAAQ,CAAC,EACT,QAAQ,EAAE,EACM;IAChB,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,2NAAQ,EAAC;IACnD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,2NAAQ,EAAC;IAC3C,MAAM,aAAa,IAAA,yNAAM,EAAiB;IAE1C,IAAA,4NAAS,EAAC;QACN,MAAM,WAAW,IAAI,qBACjB,CAAC,CAAC,MAAM;YACJ,IAAI,MAAM,cAAc,IAAI,CAAC,WAAW;gBACpC,aAAa;YACjB;QACJ,GACA;YAAE,WAAW;QAAI;QAGrB,IAAI,WAAW,OAAO,EAAE;YACpB,SAAS,OAAO,CAAC,WAAW,OAAO;QACvC;QAEA,OAAO,IAAM,SAAS,UAAU;IACpC,GAAG;QAAC;KAAU;IAEd,IAAA,4NAAS,EAAC;QACN,IAAI,CAAC,WAAW;QAEhB,MAAM,UAAU,WAAW;YACvB,IAAI,eAAe;YACnB,MAAM,WAAW,YAAY;gBACzB,IAAI,gBAAgB,KAAK,MAAM,EAAE;oBAC7B,iBAAiB,KAAK,KAAK,CAAC,GAAG;oBAC/B;gBACJ,OAAO;oBACH,cAAc;gBAClB;YACJ,GAAG;YAEH,OAAO,IAAM,cAAc;QAC/B,GAAG;QAEH,OAAO,IAAM,aAAa;IAC9B,GAAG;QAAC;QAAW;QAAM;QAAO;KAAM;IAElC,qBACI,wPAAC;QAAI,KAAK;QAAY,WAAW;;YAC5B;0BACD,wPAAC;gBAAK,WAAU;0BAAgB;;;;;;;;;;;;AAG5C"}},
    {"offset": {"line": 83, "column": 0}, "map": {"version":3,"sources":["file:///Users/piyushraj/Desktop/CyberShieldX/Piyush/src/components/ui/ScrollReveal.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useRef, useState } from 'react';\n\ninterface ScrollRevealProps {\n    children: React.ReactNode;\n    className?: string;\n    delay?: number;\n}\n\nexport default function ScrollReveal({\n    children,\n    className = '',\n    delay = 0\n}: ScrollRevealProps) {\n    const [isVisible, setIsVisible] = useState(false);\n    const elementRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n        const observer = new IntersectionObserver(\n            ([entry]) => {\n                if (entry.isIntersecting) {\n                    setTimeout(() => setIsVisible(true), delay);\n                }\n            },\n            { threshold: 0.1 }\n        );\n\n        if (elementRef.current) {\n            observer.observe(elementRef.current);\n        }\n\n        return () => observer.disconnect();\n    }, [delay]);\n\n    return (\n        <div\n            ref={elementRef}\n            className={`transition-all duration-700 ${isVisible\n                    ? 'opacity-100 translate-y-0'\n                    : 'opacity-0 translate-y-8'\n                } ${className}`}\n        >\n            {children}\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAUe,SAAS,aAAa,EACjC,QAAQ,EACR,YAAY,EAAE,EACd,QAAQ,CAAC,EACO;IAChB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,2NAAQ,EAAC;IAC3C,MAAM,aAAa,IAAA,yNAAM,EAAiB;IAE1C,IAAA,4NAAS,EAAC;QACN,MAAM,WAAW,IAAI,qBACjB,CAAC,CAAC,MAAM;YACJ,IAAI,MAAM,cAAc,EAAE;gBACtB,WAAW,IAAM,aAAa,OAAO;YACzC;QACJ,GACA;YAAE,WAAW;QAAI;QAGrB,IAAI,WAAW,OAAO,EAAE;YACpB,SAAS,OAAO,CAAC,WAAW,OAAO;QACvC;QAEA,OAAO,IAAM,SAAS,UAAU;IACpC,GAAG;QAAC;KAAM;IAEV,qBACI,wPAAC;QACG,KAAK;QACL,WAAW,CAAC,4BAA4B,EAAE,YAChC,8BACA,0BACL,CAAC,EAAE,WAAW;kBAElB;;;;;;AAGb"}},
    {"offset": {"line": 184, "column": 0}, "map": {"version":3,"sources":["file:///Users/piyushraj/Desktop/CyberShieldX/Piyush/src/lib/analyzer/MessageAnalyzer.ts"],"sourcesContent":["import Papa from 'papaparse';\n\n// Define CrimePattern interface if not already available\nexport interface CrimePattern {\n    type: string;\n    description: string;\n    severity: 'low' | 'medium' | 'high' | 'critical';\n    confidence: number;\n}\n\nexport interface AnalysisResult {\n    category: 'safe' | 'mild' | 'harassment' | 'high-risk';\n    toxicityScore: number; // 0-100\n    confidenceScore: number; // 0-100\n    matchedKeywords: string[];\n    summary: string;\n    crimePattern?: CrimePattern;\n    similarExamples?: Array<{\n        message: string;\n        toxicity_label: string;\n        crime_type: string;\n        similarity: number;\n    }>;\n    sentiment?: {\n        score: number;\n        comparative: number;\n        tokens: string[];\n        words: string[];\n        positive: string[];\n        negative: string[];\n    };\n}\n\ninterface DatasetRow {\n    message_text: string;\n    toxicity_label: string;\n    toxicity_score: string;\n    confidence: string;\n    crime_type: string;\n    severity_level: string;\n    legal_section: string;\n    matched_keywords: string;\n}\n\nexport class MessageAnalyzer {\n    private cache: Map<string, AnalysisResult>;\n    private dataset: DatasetRow[] = [];\n    private datasetLoaded: boolean = false;\n\n    // Keyword dictionaries (enhanced from dataset)\n    private threats = ['kill', 'murder', 'hurt', 'attack', 'bomb', 'shoot', 'stab', 'die', 'burn', 'destroy', 'threat', 'coming for you', 'regret'];\n    private harassment = ['stupid', 'idiot', 'ugly', 'fat', 'hate', 'trash', 'failure', 'useless', 'disgusting', 'creepy', 'worthless', 'pathetic'];\n    private fraud = ['bank', 'account', 'password', 'credit card', 'transfer', 'money', 'urgent', 'winner', 'lottery', 'otp', 'verify', 'kyc', 'upi'];\n\n    // Basic sentiment dictionaries\n    private positiveWords = ['good', 'great', 'awesome', 'nice', 'happy', 'love', 'excellent', 'best', 'wonderful', 'safe'];\n    private negativeWords = ['bad', 'terrible', 'awful', 'sad', 'hate', 'worst', 'horrible', 'dangerous', 'fail', 'poor'];\n\n    constructor() {\n        this.cache = new Map();\n        this.loadDataset();\n    }\n\n    /**\n     * Load dataset from CSV file\n     */\n    private async loadDataset() {\n        if (this.datasetLoaded) return;\n\n        try {\n            const response = await fetch('/data/cybershieldx_dataset.csv');\n            const csvText = await response.text();\n\n            Papa.parse(csvText, {\n                header: true,\n                skipEmptyLines: true,\n                complete: (results) => {\n                    this.dataset = results.data as DatasetRow[];\n                    this.datasetLoaded = true;\n                    console.log(`✅ Dataset loaded: ${this.dataset.length} examples`);\n                },\n                error: (error: Error) => {\n                    console.error('❌ Error loading dataset:', error);\n                }\n            });\n        } catch (error) {\n            console.error('❌ Failed to fetch dataset:', error);\n        }\n    }\n\n    /**\n     * Main entry point for message analysis\n     */\n    public async analyze(message: string): Promise<AnalysisResult> {\n        if (!message || message.trim().length === 0) {\n            return this.createEmptyResult();\n        }\n\n        const cacheKey = this.getCacheKey(message);\n        if (this.cache.has(cacheKey)) {\n            return this.cache.get(cacheKey)!;\n        }\n\n        // Wait for dataset to load if not already loaded\n        if (!this.datasetLoaded) {\n            await this.waitForDataset();\n        }\n\n        // Find similar examples from dataset\n        const similarExamples = this.findSimilarMessages(message);\n\n        const sentimentResult = this.simpleSentimentAnalysis(message);\n        const keywords = this.detectKeywords(message);\n\n        // Enhanced scoring using dataset\n        const toxicityScore = this.calculateEnhancedToxicityScore(message, keywords, sentimentResult, similarExamples);\n        const category = this.determineCategory(toxicityScore, keywords);\n\n        const result: AnalysisResult = {\n            category,\n            toxicityScore,\n            confidenceScore: this.calculateConfidence(message, keywords, similarExamples),\n            matchedKeywords: keywords.all,\n            summary: this.generateSummary(category, keywords.all, sentimentResult.score, similarExamples),\n            similarExamples: similarExamples.slice(0, 3), // Top 3 similar examples\n            sentiment: {\n                score: sentimentResult.score,\n                comparative: sentimentResult.comparative,\n                tokens: sentimentResult.tokens,\n                words: sentimentResult.words,\n                positive: sentimentResult.positive,\n                negative: sentimentResult.negative\n            }\n        };\n\n        // Enhanced crime pattern detection using dataset\n        if (category === 'high-risk' || category === 'harassment') {\n            result.crimePattern = this.detectCrimePatternFromDataset(keywords, similarExamples);\n        }\n\n        this.cache.set(cacheKey, result);\n        return result;\n    }\n\n    /**\n     * Wait for dataset to load\n     */\n    private async waitForDataset(maxWait: number = 3000): Promise<void> {\n        const startTime = Date.now();\n        while (!this.datasetLoaded && (Date.now() - startTime) < maxWait) {\n            await new Promise(resolve => setTimeout(resolve, 100));\n        }\n    }\n\n    /**\n     * Find similar messages in dataset using keyword matching and text similarity\n     */\n    private findSimilarMessages(message: string): Array<{\n        message: string;\n        toxicity_label: string;\n        crime_type: string;\n        similarity: number;\n    }> {\n        if (!this.datasetLoaded || this.dataset.length === 0) {\n            return [];\n        }\n\n        const messageLower = message.toLowerCase();\n        const messageWords = new Set(messageLower.split(/\\s+/));\n\n        const similarities = this.dataset.map(row => {\n            const rowWords = new Set(row.message_text.toLowerCase().split(/\\s+/));\n            const intersection = new Set([...messageWords].filter(x => rowWords.has(x)));\n            const union = new Set([...messageWords, ...rowWords]);\n            const similarity = intersection.size / union.size; // Jaccard similarity\n\n            return {\n                message: row.message_text,\n                toxicity_label: row.toxicity_label,\n                crime_type: row.crime_type || 'None',\n                similarity: similarity * 100\n            };\n        });\n\n        // Sort by similarity and return top matches\n        return similarities\n            .filter(s => s.similarity > 10) // At least 10% similarity\n            .sort((a, b) => b.similarity - a.similarity)\n            .slice(0, 5);\n    }\n\n    /**\n     * Enhanced toxicity scoring using dataset examples\n     */\n    private calculateEnhancedToxicityScore(\n        message: string,\n        keywords: { threats: string[], harassment: string[], fraud: string[] },\n        sentiment: any,\n        similarExamples: any[]\n    ): number {\n        let score = 0;\n\n        // Base score from keywords\n        score += keywords.threats.length * 30;\n        score += keywords.harassment.length * 15;\n        score += keywords.fraud.length * 20;\n\n        // Adjust based on sentiment\n        if (sentiment.score < 0) {\n            score += Math.abs(sentiment.score) * 2;\n        }\n\n        // Boost score if similar high-risk examples found in dataset\n        if (similarExamples.length > 0) {\n            const avgSimilarity = similarExamples.reduce((sum, ex) => sum + ex.similarity, 0) / similarExamples.length;\n            const highRiskCount = similarExamples.filter(ex =>\n                ex.toxicity_label.includes('High-Risk') ||\n                ex.toxicity_label.includes('Threat')\n            ).length;\n\n            if (highRiskCount > 0) {\n                score += avgSimilarity * 0.5; // Add up to 50 points based on similarity\n            }\n        }\n\n        // Cap at 100\n        return Math.min(100, Math.max(0, score));\n    }\n\n    /**\n     * Detect crime pattern using dataset information\n     */\n    private detectCrimePatternFromDataset(\n        keywords: { threats: string[], harassment: string[], fraud: string[] },\n        similarExamples: any[]\n    ): CrimePattern | undefined {\n        // Use dataset examples to determine crime type\n        if (similarExamples.length > 0 && similarExamples[0].crime_type !== 'None') {\n            const topExample = similarExamples[0];\n            let severity: 'low' | 'medium' | 'high' | 'critical' = 'medium';\n\n            if (topExample.toxicity_label.includes('High-Risk') || topExample.toxicity_label.includes('Critical')) {\n                severity = 'critical';\n            } else if (topExample.toxicity_label.includes('Harassment')) {\n                severity = 'high';\n            } else if (topExample.toxicity_label.includes('Mild')) {\n                severity = 'low';\n            }\n\n            return {\n                type: topExample.crime_type,\n                description: `Message matches patterns similar to ${topExample.crime_type} cases in our database.`,\n                severity,\n                confidence: Math.round(topExample.similarity)\n            };\n        }\n\n        // Fallback to keyword-based detection\n        if (keywords.threats.length > 0) {\n            return {\n                type: 'Criminal Threat',\n                description: 'Message contains keywords associated with physical threats or severe bullying.',\n                severity: 'high',\n                confidence: 85\n            };\n        }\n        if (keywords.fraud.length > 0) {\n            return {\n                type: 'Financial Fraud',\n                description: 'Message contains keywords associated with financial scams or fraud.',\n                severity: 'high',\n                confidence: 80\n            };\n        }\n        if (keywords.harassment.length > 0) {\n            return {\n                type: 'Online Harassment',\n                description: 'Message contains harassing language.',\n                severity: 'medium',\n                confidence: 75\n            };\n        }\n        return undefined;\n    }\n\n    private getCacheKey(message: string): string {\n        return Buffer.from(message).toString('base64');\n    }\n\n    private createEmptyResult(): AnalysisResult {\n        return {\n            category: 'safe',\n            toxicityScore: 0,\n            confidenceScore: 0,\n            matchedKeywords: [],\n            summary: 'Message is empty.',\n        };\n    }\n\n    private detectKeywords(message: string) {\n        const lowerMsg = message.toLowerCase();\n        const matchedThreats = this.threats.filter(w => lowerMsg.includes(w));\n        const matchedHarassment = this.harassment.filter(w => lowerMsg.includes(w));\n        const matchedFraud = this.fraud.filter(w => lowerMsg.includes(w));\n\n        return {\n            threats: matchedThreats,\n            harassment: matchedHarassment,\n            fraud: matchedFraud,\n            all: [...matchedThreats, ...matchedHarassment, ...matchedFraud]\n        };\n    }\n\n    private simpleSentimentAnalysis(message: string) {\n        const tokens = message.toLowerCase().split(/\\s+/);\n        const positive = tokens.filter(t => this.positiveWords.includes(t));\n        const negative = tokens.filter(t => this.negativeWords.includes(t));\n        const score = positive.length - negative.length;\n        return {\n            score,\n            comparative: score / tokens.length,\n            tokens,\n            words: [...positive, ...negative],\n            positive,\n            negative\n        };\n    }\n\n    private determineCategory(score: number, keywords: { threats: string[], harassment: string[], fraud: string[] }): 'safe' | 'mild' | 'harassment' | 'high-risk' {\n        if (keywords.threats.length > 0) return 'high-risk';\n        if (keywords.fraud.length > 0) return 'high-risk';\n        if (score > 60) return 'high-risk';\n        if (score > 30) return 'harassment';\n        if (score > 10) return 'mild';\n        return 'safe';\n    }\n\n    private calculateConfidence(message: string, keywords: { all: string[] }, similarExamples: any[]): number {\n        let confidence = 70; // Base confidence\n\n        if (keywords.all.length > 0) confidence += 10;\n        if (message.length > 20) confidence += 10;\n        if (message.length < 5) confidence -= 20;\n\n        // Boost confidence if we found similar examples in dataset\n        if (similarExamples.length > 0) {\n            confidence += Math.min(15, similarExamples[0].similarity / 5);\n        }\n\n        return Math.min(100, Math.max(0, confidence));\n    }\n\n    private generateSummary(category: string, keywords: string[], sentimentScore: number, similarExamples: any[]): string {\n        const sentimentDesc = sentimentScore < 0 ? 'negative' : (sentimentScore > 0 ? 'positive' : 'neutral');\n\n        if (category === 'safe') {\n            return `The message appears safe with ${sentimentDesc} sentiment.`;\n        }\n\n        let summary = `Detected ${category} content. Found keywords: ${keywords.join(', ') || 'None'}. Sentiment is ${sentimentDesc}.`;\n\n        if (similarExamples.length > 0) {\n            summary += ` This message is ${Math.round(similarExamples[0].similarity)}% similar to known ${similarExamples[0].toxicity_label} cases in our database.`;\n        }\n\n        return summary;\n    }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 523, "column": 0}, "map": {"version":3,"sources":["file:///Users/piyushraj/Desktop/CyberShieldX/Piyush/src/lib/supabase/client.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\n\n// Create a single supabase client for interacting with your database\nexport const supabase = createClient(supabaseUrl, supabaseKey);\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAGC,MAAM,WAAW,IAAA,wMAAY,EAAC,aAAa"}},
    {"offset": {"line": 536, "column": 0}, "map": {"version":3,"sources":["file:///Users/piyushraj/Desktop/CyberShieldX/Piyush/src/components/evidence/OCRAnalyzer.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback, useRef } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport Tesseract from 'tesseract.js';\nimport { Loader2, Upload, FileText, X, AlertTriangle, CheckCircle, Save, Smartphone } from 'lucide-react';\nimport { MessageAnalyzer, AnalysisResult } from '@/lib/analyzer/MessageAnalyzer';\nimport { OCRResult, Evidence } from '@/types';\nimport { supabase } from '@/lib/supabase/client';\n\ninterface OCRAnalyzerProps {\n    onAnalysisComplete?: (text: string, evidenceItems: Evidence[]) => void;\n}\n\nexport default function OCRAnalyzer({ onAnalysisComplete }: OCRAnalyzerProps) {\n    const [file, setFile] = useState<File | null>(null);\n    const [preview, setPreview] = useState<string | null>(null);\n    const [isProcessing, setIsProcessing] = useState(false);\n    const [ocrResult, setOcrResult] = useState<OCRResult | null>(null);\n    const [analysis, setAnalysis] = useState<AnalysisResult | null>(null);\n    const [isSaving, setIsSaving] = useState(false);\n    const [saveStatus, setSaveStatus] = useState<'idle' | 'success' | 'error'>('idle');\n\n    const onDrop = useCallback((acceptedFiles: File[]) => {\n        const selectedFile = acceptedFiles[0];\n        if (selectedFile) {\n            setFile(selectedFile);\n            setPreview(URL.createObjectURL(selectedFile));\n            setOcrResult(null);\n            setAnalysis(null);\n            setSaveStatus('idle');\n            processImage(selectedFile);\n        }\n    }, []);\n\n    const { getRootProps, getInputProps, isDragActive } = useDropzone({\n        onDrop,\n        accept: {\n            'image/*': ['.png', '.jpg', '.jpeg', '.bmp']\n        },\n        maxFiles: 1\n    });\n\n    const processImage = async (imageFile: File) => {\n        setIsProcessing(true);\n        setOcrResult(null);\n        setAnalysis(null);\n\n        try {\n            const result = await Tesseract.recognize(\n                imageFile,\n                'eng',\n                {\n                    logger: m => {\n                        if (m.status === 'recognizing text') {\n                            setOcrResult(prev => ({\n                                text: prev?.text || '',\n                                confidence: prev?.confidence || 0,\n                                progress: m.progress,\n                                status: m.status\n                            }));\n                        }\n                    }\n                }\n            );\n\n            const text = result.data.text;\n            const confidence = result.data.confidence;\n\n            setOcrResult({\n                text,\n                confidence,\n                progress: 1,\n                status: 'completed'\n            });\n\n            // Analyze extracted text\n            const analyzer = new MessageAnalyzer();\n            const analysisResult = await analyzer.analyze(text);\n            setAnalysis(analysisResult);\n\n            if (onAnalysisComplete) {\n                // Create a temporary evidence item for the parent to display/use\n                const tempEvidence: Evidence = {\n                    id: `temp-${Date.now()}`,\n                    type: 'image',\n                    url: URL.createObjectURL(imageFile), // Use local blob for preview\n                    filename: imageFile.name,\n                    fileSize: imageFile.size,\n                    mimeType: imageFile.type,\n                    metadata: {\n                        extractedText: text,\n                        ocrConfidence: confidence\n                    },\n                    analysis: analysisResult,\n                    createdAt: new Date().toISOString()\n                };\n                onAnalysisComplete(text, [tempEvidence]);\n            }\n\n        } catch (error) {\n            console.error('OCR Error:', error);\n            setOcrResult({\n                text: 'Error processing image',\n                confidence: 0,\n                progress: 0,\n                status: 'error'\n            });\n        } finally {\n            setIsProcessing(false);\n        }\n    };\n\n    const handleClear = () => {\n        setFile(null);\n        setPreview(null);\n        setOcrResult(null);\n        setAnalysis(null);\n        setSaveStatus('idle');\n    };\n\n    const handleSave = async () => {\n        if (!file || !ocrResult || !analysis) return;\n\n        setIsSaving(true);\n        try {\n            // 1. Upload image to Storage\n            const fileName = `${Date.now()}_${file.name}`;\n            const { data: uploadData, error: uploadError } = await supabase.storage\n                .from('evidence')\n                .upload(fileName, file);\n\n            if (uploadError) throw uploadError;\n\n            // 2. Get Public URL\n            const { data: { publicUrl } } = supabase.storage\n                .from('evidence')\n                .getPublicUrl(fileName);\n\n            // 3. Save Evidence Record\n            const evidenceData: Partial<Evidence> = {\n                type: 'image',\n                url: publicUrl,\n                filename: fileName,\n                fileSize: file.size,\n                mimeType: file.type,\n                metadata: {\n                    width: 0, // Would need Image object to get this\n                    height: 0,\n                    extractedText: ocrResult.text,\n                    ocrConfidence: ocrResult.confidence\n                },\n                analysis: analysis,\n                createdAt: new Date().toISOString()\n            };\n\n            const { error: dbError } = await supabase\n                .from('evidence')\n                .insert([evidenceData]);\n\n            if (dbError) throw dbError;\n\n            setSaveStatus('success');\n            setTimeout(() => setSaveStatus('idle'), 3000);\n\n        } catch (error) {\n            console.error('Save Error:', error);\n            setSaveStatus('error');\n        } finally {\n            setIsSaving(false);\n        }\n    };\n\n    return (\n        <div className=\"w-full max-w-4xl mx-auto p-6 space-y-6\">\n            <div className=\"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden\">\n                <div className=\"p-6 border-b border-gray-100 bg-gray-50/50\">\n                    <h2 className=\"text-xl font-bold flex items-center gap-2 text-gray-800\">\n                        <Smartphone className=\"w-6 h-6 text-blue-600\" />\n                        Evidence Analyzer\n                    </h2>\n                    <p className=\"text-sm text-gray-500 mt-1\">\n                        Extract text from screenshots and analyze for toxic content using client-side OCR.\n                    </p>\n                </div>\n\n                <div className=\"p-6 space-y-8\">\n                    {/* Upload Area */}\n                    {!file && (\n                        <div\n                            {...getRootProps()}\n                            className={`border-2 border-dashed rounded-xl p-12 flex flex-col items-center justify-center cursor-pointer transition-all duration-200\n                ${isDragActive ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'}`}\n                        >\n                            <input {...getInputProps()} />\n                            <div className=\"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-4\">\n                                <Upload className=\"w-8 h-8 text-blue-600\" />\n                            </div>\n                            <p className=\"text-lg font-medium text-gray-700\">Drop your screenshot here</p>\n                            <p className=\"text-sm text-gray-400 mt-2\">Supports JPG, PNG, BMP</p>\n                        </div>\n                    )}\n\n                    {/* Preview & Results */}\n                    {file && (\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n                            {/* Left Column: Image Preview */}\n                            <div className=\"space-y-4\">\n                                <div className=\"flex items-center justify-between\">\n                                    <h3 className=\"font-semibold text-gray-700\">Evidence Preview</h3>\n                                    <button\n                                        onClick={handleClear}\n                                        className=\"text-sm text-red-500 hover:text-red-600 flex items-center gap-1 px-2 py-1 rounded hover:bg-red-50 transition-colors\"\n                                    >\n                                        <X className=\"w-4 h-4\" /> Clear\n                                    </button>\n                                </div>\n\n                                <div className=\"relative rounded-lg overflow-hidden border border-gray-200 bg-gray-900 group\">\n                                    {/* eslint-disable-next-line @next/next/no-img-element */}\n                                    <img src={preview!} alt=\"Evidence\" className=\"w-full h-auto object-contain max-h-[500px]\" />\n\n                                    {isProcessing && (\n                                        <div className=\"absolute inset-0 bg-black/60 flex flex-col items-center justify-center text-white backdrop-blur-sm\">\n                                            <Loader2 className=\"w-8 h-8 animate-spin mb-2\" />\n                                            <span className=\"font-medium\">Extracting Text...</span>\n                                            {ocrResult?.progress && (\n                                                <div className=\"w-48 h-2 bg-gray-700 rounded-full mt-4 overflow-hidden\">\n                                                    <div\n                                                        className=\"h-full bg-blue-500 transition-all duration-300\"\n                                                        style={{ width: `${Math.round(ocrResult.progress * 100)}%` }}\n                                                    />\n                                                </div>\n                                            )}\n                                        </div>\n                                    )}\n                                </div>\n\n                                {ocrResult?.status === 'completed' && (\n                                    <div className=\"flex items-center justify-between text-sm text-gray-500 bg-gray-50 p-2 rounded-lg border border-gray-100\">\n                                        <span className=\"flex items-center gap-1\">\n                                            <FileText className=\"w-4 h-4\" />\n                                            {file.name}\n                                        </span>\n                                        <span>\n                                            Confidence: {Math.round(ocrResult.confidence)}%\n                                        </span>\n                                    </div>\n                                )}\n                            </div>\n\n                            {/* Right Column: Analysis Results */}\n                            <div className=\"space-y-6\">\n                                {/* Extracted Text */}\n                                <div className=\"space-y-2\">\n                                    <h3 className=\"font-semibold text-gray-700 flex items-center gap-2\">\n                                        <FileText className=\"w-4 h-4 text-blue-500\" />\n                                        Extracted Content\n                                    </h3>\n                                    <div className=\"bg-gray-50 rounded-lg p-4 h-48 overflow-y-auto text-sm border border-gray-100\">\n                                        {ocrResult?.text ? (\n                                            <p className=\"whitespace-pre-wrap text-gray-700\">{ocrResult.text}</p>\n                                        ) : (\n                                            <p className=\"text-gray-400 italic\">No text extracted yet...</p>\n                                        )}\n                                    </div>\n                                </div>\n\n                                {/* Analysis Report */}\n                                {analysis && (\n                                    <div className=\"space-y-4 animate-in fade-in duration-500\">\n                                        <h3 className=\"font-semibold text-gray-700 flex items-center gap-2\">\n                                            <AlertTriangle className=\"w-4 h-4 text-orange-500\" />\n                                            Risk Analysis\n                                        </h3>\n\n                                        <div className={`p-4 rounded-xl border ${analysis.category === 'safe' ? 'bg-green-50 border-green-100' :\n                                            analysis.category === 'mild' ? 'bg-yellow-50 border-yellow-100' :\n                                                'bg-red-50 border-red-100'\n                                            }`}>\n                                            <div className=\"flex justify-between items-start mb-2\">\n                                                <span className={`px-2.5 py-0.5 rounded-full text-xs font-semibold capitalize\n                            ${analysis.category === 'safe' ? 'bg-green-100 text-green-700' :\n                                                        analysis.category === 'mild' ? 'bg-yellow-100 text-yellow-700' :\n                                                            'bg-red-100 text-red-700'}`}>\n                                                    {analysis.category}\n                                                </span>\n                                                <span className=\"text-xs font-mono text-gray-500\">\n                                                    Score: {analysis.toxicityScore}/100\n                                                </span>\n                                            </div>\n                                            <p className=\"text-sm text-gray-700 font-medium\">\n                                                {analysis.summary}\n                                            </p>\n                                        </div>\n\n                                        {analysis.matchedKeywords && analysis.matchedKeywords.length > 0 && (\n                                            <div>\n                                                <span className=\"text-xs font-medium text-gray-500 uppercase tracking-wider\">Detected Keywords</span>\n                                                <div className=\"flex gap-2 flex-wrap mt-2\">\n                                                    {analysis.matchedKeywords.map((keyword, i) => (\n                                                        <span key={i} className=\"px-2 py-1 bg-red-50 text-red-600 text-xs rounded border border-red-100\">\n                                                            {keyword}\n                                                        </span>\n                                                    ))}\n                                                </div>\n                                            </div>\n                                        )}\n                                    </div>\n                                )}\n\n                                {/* Save Button */}\n                                {analysis && (\n                                    <button\n                                        onClick={handleSave}\n                                        disabled={isSaving || saveStatus === 'success'}\n                                        className={`w-full py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-all\n                      ${saveStatus === 'success'\n                                                ? 'bg-green-500 text-white'\n                                                : 'bg-gray-900 text-white hover:bg-black active:scale-[0.98]'\n                                            } disabled:opacity-70 disabled:cursor-not-allowed`}\n                                    >\n                                        {isSaving ? (\n                                            <Loader2 className=\"w-5 h-5 animate-spin\" />\n                                        ) : saveStatus === 'success' ? (\n                                            <>\n                                                <CheckCircle className=\"w-5 h-5\" /> Saved to Vault\n                                            </>\n                                        ) : (\n                                            <>\n                                                <Save className=\"w-5 h-5\" /> Save Evidence\n                                            </>\n                                        )}\n                                    </button>\n                                )}\n\n                                {saveStatus === 'error' && (\n                                    <p className=\"text-xs text-red-500 text-center\">\n                                        Failed to save evidence. Check your connection or API keys.\n                                    </p>\n                                )}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1169, "column": 0}, "map": {"version":3,"sources":["file:///Users/piyushraj/Desktop/CyberShieldX/Piyush/src/lib/crime/PatternDetector.ts"],"sourcesContent":["export enum Severity {\n    LOW = 'Low',\n    MEDIUM = 'Medium',\n    HIGH = 'High',\n    CRITICAL = 'Critical'\n}\n\nexport enum CrimeCategory {\n    UNAUTHORIZED_ACCESS = 'Account Hacking / Unauthorized Access',\n    EXTORTION = 'Extortion / Blackmail',\n    HARASSMENT = 'Online Harassment',\n    THREATS = 'Threats and Violence',\n    FRAUD = 'Financial Fraud',\n    IDENTITY_THEFT = 'Identity Theft',\n    CHILD_EXPLOITATION = 'Child Exploitation'\n}\n\nexport interface LegalReference {\n    code: string;\n    section: string;\n    description: string;\n}\n\n// Alias for compatibility if needed, or separate interface\nexport interface LegalProvision {\n    act: string;\n    section: string;\n    description: string;\n}\n\nexport interface InvestigationStep {\n    id: string; // e.g., 'step-1'\n    action: string;\n    description: string;\n    requiredTools?: string[]; // e.g., 'IP Tracker', 'Email Header Analyzer'\n    priority?: Severity; // Added to match Assistant usage\n}\n\nexport interface CrimeAnalysisResult {\n    detected: boolean;\n    categories: CrimeCategory[]; // Changed to array to match component usage\n    severity: Severity;\n    legalProvisions: LegalProvision[];\n    investigationSteps: InvestigationStep[];\n    matchedKeywords: string[];\n}\n\nexport interface CrimeMatch {\n    category: string;\n    confidence: number;\n    severity: Severity;\n    matchedKeywords: string[];\n    legalReferences: LegalReference[];\n    investigationSteps: InvestigationStep[];\n    requiresImmediateEscalation: boolean;\n}\n\ninterface PatternRule {\n    id: string;\n    name: string;\n    keywords: string[];\n    regex?: RegExp[];\n    severity: Severity;\n    legalReferences: LegalReference[];\n    investigationSteps: InvestigationStep[];\n}\n\n// ... (Enums and Interfaces are already defined)\n\nexport class PatternDetector {\n    private rules: PatternRule[] = [\n        {\n            id: 'unauthorized_access',\n            name: CrimeCategory.UNAUTHORIZED_ACCESS,\n            severity: Severity.HIGH,\n            keywords: ['hacked', 'password stolen', 'unauthorized login', 'account compromise', 'suspicious activity', 'login alert', 'brute force', 'breach'],\n            regex: [/password\\s*stolen/i, /un-?authorized\\s*access/i, /account\\s*hack(ed|ing)/i],\n            legalReferences: [\n                { code: 'IT Act, 2000', section: 'Section 66', description: 'Computer Related Offences - Hacking' },\n                { code: 'IT Act, 2000', section: 'Section 43', description: 'Penalty and compensation for damage to computer, computer system, etc.' }\n            ],\n            investigationSteps: [\n                { id: 'ua-1', action: 'Secure Account', description: 'Immediately change passwords and enable 2FA if matched.' },\n                { id: 'ua-2', action: 'Check Login Logs', description: 'Review account activity logs for IP addresses and device info.' },\n                { id: 'ua-3', action: 'Email Header Analysis', description: 'If phishing was involved, analyze email headers.' }\n            ]\n        },\n        {\n            id: 'extortion',\n            name: CrimeCategory.EXTORTION,\n            severity: Severity.HIGH,\n            keywords: ['blackmail', 'ransom', 'pay me', 'expose you', 'leak', 'threaten', 'sextortion'],\n            regex: [/pay\\s*me/i, /leak\\s*(your\\s*)?(photos|videos|chats)/i, /expose\\s*(you|ur)/i, /distribute\\s*(nudes|pics)/i],\n            legalReferences: [\n                { code: 'IPC', section: 'Section 383', description: 'Extortion' },\n                { code: 'IPC', section: 'Section 503', description: 'Criminal Intimidation' },\n                { code: 'IT Act, 2000', section: 'Section 66E', description: 'Violation of privacy' }\n            ],\n            investigationSteps: [\n                { id: 'ex-1', action: 'Preserve Evidence', description: 'Take screenshots of all threats and demands. Do not delete messages.' },\n                { id: 'ex-2', action: 'Profile Attacker', description: 'Gather social media profile URLs or phone numbers used for threats.' },\n                { id: 'ex-3', action: 'Financial Trace', description: 'If payment demanded via crypto/bank, note down wallet/account details.' }\n            ]\n        },\n        {\n            id: 'harassment',\n            name: CrimeCategory.HARASSMENT,\n            severity: Severity.MEDIUM,\n            keywords: ['harass', 'stalking', 'troll', 'abuse', 'hate speech', 'offensive', 'bullying', 'stupid', 'ugly', 'idiot', 'die'],\n            regex: [/stop\\s*posting/i, /you\\s*are\\s*(ugly|stupid|idiot)/i, /kill\\s*yourself/i],\n            legalReferences: [\n                { code: 'IPC', section: 'Section 354D', description: 'Stalking' },\n                { code: 'IT Act, 2000', section: 'Section 67', description: 'Publishing incidental material in electronic form' }\n            ],\n            investigationSteps: [\n                { id: 'hr-1', action: 'Block and Report', description: 'Use platform reporting tools to block the user.' },\n                { id: 'hr-2', action: 'Timeline Documentation', description: 'Create a timeline of harassment incidents.' },\n                { id: 'hr-3', action: 'Identify Platform', description: 'Determine platform policies and relevant contact forms.' }\n            ]\n        },\n        {\n            id: 'threats',\n            name: CrimeCategory.THREATS,\n            severity: Severity.CRITICAL,\n            keywords: ['kill you', 'hurt you', 'bomb', 'attack', 'murder', 'violence', 'beat you', 'physical harm'],\n            regex: [/kill\\s*(you|ur|him|her)/i, /break\\s*(bones|legs)/i],\n            legalReferences: [\n                { code: 'IPC', section: 'Section 506', description: 'Punishment for criminal intimidation' }\n            ],\n            investigationSteps: [\n                { id: 'th-1', action: 'Immediate Safety', description: 'Ensure physical safety. Contact local law enforcement immediately.' },\n                { id: 'th-2', action: 'Preserve Communications', description: 'Save all threatening messages as evidence.' }\n            ]\n        },\n        {\n            id: 'financial_fraud',\n            name: CrimeCategory.FRAUD,\n            severity: Severity.HIGH,\n            keywords: ['scam', 'fraud', 'bank transfer', 'up front payment', 'fake website', 'credit card', 'money lost', 'phishing', 'otp'],\n            regex: [/send\\s*money/i, /bank\\s*details/i, /credit\\s*card\\s*number/i],\n            legalReferences: [\n                { code: 'IPC', section: 'Section 420', description: 'Cheating and dishonestly inducing delivery of property' },\n                { code: 'IT Act, 2000', section: 'Section 66D', description: 'Punishment for cheating by personation by using computer resource' }\n            ],\n            investigationSteps: [\n                { id: 'ff-1', action: 'Contact Bank', description: 'Call bank helpline to freeze accounts/cards immediately.' },\n                { id: 'ff-2', action: 'Cyber Cell Report', description: 'File a complaint at cybercrime.gov.in.' },\n                { id: 'ff-3', action: 'Transaction Details', description: 'Collect transaction IDs, screenshots, and bank statements.' }\n            ]\n        },\n        {\n            id: 'identity_theft',\n            name: CrimeCategory.IDENTITY_THEFT,\n            severity: Severity.HIGH,\n            keywords: ['impersonation', 'fake profile', 'using my photos', 'pretending to be me', 'identity theft', 'fake account'],\n            regex: [/fake\\s*id/i, /my\\s*photos/i],\n            legalReferences: [\n                { code: 'IT Act, 2000', section: 'Section 66C', description: 'Punishment for identity theft' },\n                { code: 'IPC', section: 'Section 419', description: 'Punishment for cheating by personation' }\n            ],\n            investigationSteps: [\n                { id: 'it-1', action: 'Report Impersonation', description: 'Report the fake profile to the platform provider.' },\n                { id: 'it-2', action: 'Public Notice', description: 'Inform contacts not to engage with the fake profile.' },\n                { id: 'it-3', action: 'Monitor Accounts', description: 'Check for unauthorized financial or social activity.' }\n            ]\n        },\n        {\n            id: 'child_exploitation',\n            name: CrimeCategory.CHILD_EXPLOITATION,\n            severity: Severity.CRITICAL,\n            keywords: ['csa', 'minor', 'child pornography', 'grooming', 'underage', 'csam', 'sexual abuse of child'],\n            regex: [/child\\s*porn/i, /underage\\s*sex/i],\n            legalReferences: [\n                { code: 'POCSO Act', section: 'Section 11', description: 'Sexual Harassment' },\n                { code: 'IT Act, 2000', section: 'Section 67B', description: 'Punishment for publishing or transmitting material depicting children in sexually explicit act' }\n            ],\n            investigationSteps: [\n                { id: 'ce-1', action: 'Emergency Escalation', description: 'IMMEDIATE REPORT REQUESTED. Contact NCMEC or local authorities.' },\n                { id: 'ce-2', action: 'Do Not Share', description: 'Do not distribute or share the material even for evidence. Report original link only.' }\n            ]\n        }\n    ];\n\n    public detect(text: string): CrimeMatch[] {\n        const normalizeText = text.toLowerCase();\n        const matches: CrimeMatch[] = [];\n\n        for (const rule of this.rules) {\n            let matchedKeywords: string[] = [];\n            let isMatch = false;\n\n            // Check keywords\n            matchedKeywords = rule.keywords.filter(keyword => normalizeText.includes(keyword));\n            if (matchedKeywords.length > 0) isMatch = true;\n\n            // Check Regex\n            if (rule.regex) {\n                for (const regex of rule.regex) {\n                    if (regex.test(text)) {\n                        isMatch = true;\n                        // We can optionally add regex match indications here\n                    }\n                }\n            }\n\n            if (isMatch) {\n                // Confidence logic\n                let confidence = 0.5;\n                if (matchedKeywords.length >= 2) confidence = 0.85;\n                if (rule.regex && rule.regex.some(r => r.test(text))) confidence = Math.max(confidence, 0.9);\n\n                matches.push({\n                    category: rule.name,\n                    confidence,\n                    severity: rule.severity,\n                    matchedKeywords,\n                    legalReferences: rule.legalReferences,\n                    investigationSteps: rule.investigationSteps,\n                    requiresImmediateEscalation: rule.severity === Severity.CRITICAL\n                });\n            }\n        }\n\n        // Sort by confidence, then severity\n        return matches.sort((a, b) => {\n            if (b.confidence !== a.confidence) return b.confidence - a.confidence;\n            // Map severity to weight\n            const severityWeight: Record<Severity, number> = {\n                [Severity.CRITICAL]: 4,\n                [Severity.HIGH]: 3,\n                [Severity.MEDIUM]: 2,\n                [Severity.LOW]: 1\n            };\n            return severityWeight[b.severity] - severityWeight[a.severity];\n        });\n    }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1580, "column": 0}, "map": {"version":3,"sources":["file:///Users/piyushraj/Desktop/CyberShieldX/Piyush/src/lib/data/datasetLoader.ts"],"sourcesContent":["import Papa from 'papaparse';\n\nexport interface DatasetEntry {\n    message?: string;\n    text?: string;\n    content?: string;\n    category?: string;\n    severity?: string;\n    keywords?: string;\n    label?: string;\n    [key: string]: any; // Allow flexible column names\n}\n\nlet cachedDataset: DatasetEntry[] | null = null;\n\nexport async function loadDataset(): Promise<DatasetEntry[]> {\n    // Return cached dataset if already loaded\n    if (cachedDataset) {\n        return cachedDataset;\n    }\n\n    try {\n        const response = await fetch('/data/dataset.csv');\n        if (!response.ok) {\n            console.warn('Dataset not found, using empty dataset');\n            return [];\n        }\n\n        const csvText = await response.text();\n\n        return new Promise((resolve) => {\n            Papa.parse(csvText, {\n                header: true,\n                skipEmptyLines: true,\n                complete: (results) => {\n                    cachedDataset = results.data as DatasetEntry[];\n                    resolve(cachedDataset);\n                },\n                error: () => {\n                    console.error('Failed to parse dataset');\n                    resolve([]);\n                }\n            });\n        });\n    } catch (error) {\n        console.error('Error loading dataset:', error);\n        return [];\n    }\n}\n\nexport function findSimilarMessages(inputText: string, dataset: DatasetEntry[]): DatasetEntry[] {\n    const input = inputText.toLowerCase().trim();\n    const matches: Array<{ entry: DatasetEntry; score: number }> = [];\n\n    dataset.forEach(entry => {\n        // Get the message text from various possible column names\n        const messageText = (\n            entry.message ||\n            entry.text ||\n            entry.content ||\n            ''\n        ).toLowerCase();\n\n        if (!messageText) return;\n\n        // Calculate similarity score\n        let score = 0;\n\n        // Exact match\n        if (messageText === input) {\n            score = 100;\n        }\n        // Contains match\n        else if (messageText.includes(input) || input.includes(messageText)) {\n            score = 80;\n        }\n        // Word overlap\n        else {\n            const inputWords = input.split(/\\s+/);\n            const messageWords = messageText.split(/\\s+/);\n            const commonWords = inputWords.filter(word =>\n                word.length > 3 && messageWords.includes(word)\n            );\n            score = (commonWords.length / Math.max(inputWords.length, messageWords.length)) * 60;\n        }\n\n        if (score > 20) {\n            matches.push({ entry, score });\n        }\n    });\n\n    // Sort by score and return top 5\n    return matches\n        .sort((a, b) => b.score - a.score)\n        .slice(0, 5)\n        .map(m => m.entry);\n}\n\nexport function extractKeywordsFromDataset(dataset: DatasetEntry[]): string[] {\n    const keywords = new Set<string>();\n\n    dataset.forEach(entry => {\n        // Extract from keywords column if exists\n        if (entry.keywords) {\n            const kws = entry.keywords.split(/[,;|]/).map(k => k.trim().toLowerCase());\n            kws.forEach(k => k && keywords.add(k));\n        }\n\n        // Extract from message text\n        const messageText = entry.message || entry.text || entry.content || '';\n        const words = messageText.toLowerCase().match(/\\b\\w{4,}\\b/g) || [];\n\n        // Add significant words (length > 3)\n        words.forEach(word => {\n            if (word.length > 3 && !['this', 'that', 'with', 'from', 'have'].includes(word)) {\n                keywords.add(word);\n            }\n        });\n    });\n\n    return Array.from(keywords);\n}\n\nexport function getCategoriesFromDataset(dataset: DatasetEntry[]): Map<string, number> {\n    const categories = new Map<string, number>();\n\n    dataset.forEach(entry => {\n        const category = entry.category || entry.label || 'unknown';\n        categories.set(category, (categories.get(category) || 0) + 1);\n    });\n\n    return categories;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1692, "column": 0}, "map": {"version":3,"sources":["file:///Users/piyushraj/Desktop/CyberShieldX/Piyush/src/components/evidence/TextAnalyzer.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { FileText, Loader2, AlertCircle, CheckCircle2, Database } from 'lucide-react';\nimport { MessageAnalyzer } from '@/lib/analyzer/MessageAnalyzer';\nimport { PatternDetector } from '@/lib/crime/PatternDetector';\nimport { Evidence } from '@/types';\nimport { loadDataset, findSimilarMessages, DatasetEntry } from '@/lib/data/datasetLoader';\n\ninterface TextAnalyzerProps {\n    onAnalysisComplete?: (text: string, evidenceItems: Evidence[]) => void;\n}\n\nexport default function TextAnalyzer({ onAnalysisComplete }: TextAnalyzerProps) {\n    const [text, setText] = useState('');\n    const [isAnalyzing, setIsAnalyzing] = useState(false);\n    const [analysisResult, setAnalysisResult] = useState<any>(null);\n    const [dataset, setDataset] = useState<DatasetEntry[]>([]);\n    const [datasetMatches, setDatasetMatches] = useState<DatasetEntry[]>([]);\n\n    // Load dataset on mount\n    useEffect(() => {\n        loadDataset().then(setDataset);\n    }, []);\n\n    const handleAnalyze = async () => {\n        if (!text.trim()) return;\n\n        setIsAnalyzing(true);\n        setAnalysisResult(null);\n\n        try {\n            // Analyze the text\n            const analyzer = new MessageAnalyzer();\n            const detector = new PatternDetector();\n\n            const analysis = await analyzer.analyze(text);\n            const patterns = detector.detect(text);\n\n            // Find similar messages in dataset\n            const matches = findSimilarMessages(text, dataset);\n            setDatasetMatches(matches);\n\n            setAnalysisResult({ analysis, patterns, datasetMatches: matches });\n\n            // Create evidence item\n            if (onAnalysisComplete) {\n                const evidence: Evidence = {\n                    id: `text-${Date.now()}`,\n                    type: 'text',\n                    url: '', // No URL for direct text\n                    filename: 'Direct Text Input',\n                    fileSize: text.length,\n                    mimeType: 'text/plain',\n                    metadata: {},\n                    analysis,\n                    createdAt: new Date().toISOString()\n                };\n\n                onAnalysisComplete(text, [evidence]);\n            }\n        } catch (error) {\n            console.error('Analysis error:', error);\n        } finally {\n            setIsAnalyzing(false);\n        }\n    };\n\n    const getSeverityColor = (category: string) => {\n        switch (category) {\n            case 'high-risk':\n                return 'text-red-500 bg-red-500/10 border-red-500/30';\n            case 'harassment':\n                return 'text-orange-500 bg-orange-500/10 border-orange-500/30';\n            case 'mild':\n                return 'text-yellow-500 bg-yellow-500/10 border-yellow-500/30';\n            case 'safe':\n                return 'text-green-500 bg-green-500/10 border-green-500/30';\n            default:\n                return 'text-gray-500 bg-gray-500/10 border-gray-500/30';\n        }\n    };\n\n    return (\n        <div className=\"space-y-6\">\n            {/* Input Section */}\n            <div className=\"bg-zinc-900 border border-white/10 rounded-xl p-6\">\n                <div className=\"flex items-center gap-2 mb-4\">\n                    <FileText className=\"w-5 h-5 text-[#00ff41]\" />\n                    <h3 className=\"text-lg font-semibold text-white\">Direct Text Analysis</h3>\n                </div>\n\n                <textarea\n                    value={text}\n                    onChange={(e) => setText(e.target.value)}\n                    placeholder=\"Paste the message or text content you want to analyze here...&#10;&#10;Example: Threatening messages, suspicious emails, social media posts, etc.\"\n                    className=\"w-full h-48 bg-black/50 border border-white/10 rounded-lg p-4 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[#00ff41]/50 resize-none font-mono text-sm\"\n                    disabled={isAnalyzing}\n                />\n\n                <div className=\"flex items-center justify-between mt-6\">\n                    <span className=\"text-sm text-[var(--text-secondary)] font-mono\">\n                        {text.length} characters\n                    </span>\n\n                    <button\n                        onClick={handleAnalyze}\n                        disabled={!text.trim() || isAnalyzing}\n                        className=\"px-8 py-3 border-2 border-[var(--accent)] text-[var(--accent)] font-bold tracking-wider hover:bg-[var(--accent)] hover:text-black transition-all duration-300 disabled:opacity-30 disabled:cursor-not-allowed text-sm flex items-center gap-2\"\n                    >\n                        {isAnalyzing ? (\n                            <>\n                                <Loader2 className=\"w-4 h-4 animate-spin\" />\n                                ANALYZING...\n                            </>\n                        ) : (\n                            <>\n                                <FileText className=\"w-4 h-4\" />\n                                [ ANALYZE TEXT ]\n                            </>\n                        )}\n                    </button>\n                </div>\n            </div>\n\n            {/* Results Section */}\n            {analysisResult && (\n                <div className=\"bg-zinc-900 border border-white/10 rounded-xl p-6 space-y-4 animate-in fade-in slide-in-from-bottom-4\">\n                    <div className=\"flex items-center gap-2 mb-4\">\n                        <CheckCircle2 className=\"w-5 h-5 text-[#00ff41]\" />\n                        <h3 className=\"text-lg font-semibold text-white\">Analysis Results</h3>\n                    </div>\n\n                    {/* Category Badge */}\n                    <div className=\"flex items-center gap-3\">\n                        <span className=\"text-sm text-gray-400\">Category:</span>\n                        <span className={`px-3 py-1 rounded-full text-sm font-medium border ${getSeverityColor(analysisResult.analysis.category)}`}>\n                            {analysisResult.analysis.category.toUpperCase()}\n                        </span>\n                    </div>\n\n                    {/* Scores */}\n                    <div className=\"grid grid-cols-2 gap-4\">\n                        <div className=\"bg-black/50 rounded-lg p-4\">\n                            <div className=\"text-xs text-gray-400 mb-1\">Toxicity Score</div>\n                            <div className=\"text-2xl font-bold text-white\">\n                                {analysisResult.analysis.toxicityScore}%\n                            </div>\n                        </div>\n                        <div className=\"bg-black/50 rounded-lg p-4\">\n                            <div className=\"text-xs text-gray-400 mb-1\">Confidence</div>\n                            <div className=\"text-2xl font-bold text-white\">\n                                {analysisResult.analysis.confidenceScore}%\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Matched Keywords */}\n                    {analysisResult.analysis.matchedKeywords.length > 0 && (\n                        <div>\n                            <div className=\"text-sm text-gray-400 mb-2\">Detected Keywords:</div>\n                            <div className=\"flex flex-wrap gap-2\">\n                                {analysisResult.analysis.matchedKeywords.map((keyword: string, idx: number) => (\n                                    <span\n                                        key={idx}\n                                        className=\"px-2 py-1 bg-red-500/10 text-red-400 border border-red-500/30 rounded text-xs font-mono\"\n                                    >\n                                        {keyword}\n                                    </span>\n                                ))}\n                            </div>\n                        </div>\n                    )}\n\n                    {/* Crime Patterns */}\n                    {analysisResult.patterns.length > 0 && (\n                        <div>\n                            <div className=\"text-sm text-gray-400 mb-2\">Crime Patterns Detected:</div>\n                            <div className=\"space-y-2\">\n                                {analysisResult.patterns.map((pattern: any, idx: number) => (\n                                    <div\n                                        key={idx}\n                                        className=\"bg-black/50 border border-orange-500/30 rounded-lg p-3\"\n                                    >\n                                        <div className=\"font-medium text-orange-400\">{pattern.category}</div>\n                                        <div className=\"text-xs text-gray-400 mt-1\">\n                                            Confidence: {(pattern.confidence * 100).toFixed(0)}% | Severity: {pattern.severity}\n                                        </div>\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n                    )}\n\n                    {/* Dataset Matches */}\n                    {datasetMatches.length > 0 && (\n                        <div>\n                            <div className=\"flex items-center gap-2 mb-2\">\n                                <Database className=\"w-4 h-4 text-[var(--accent)]\" />\n                                <div className=\"text-sm text-gray-400\">Similar Messages from Dataset:</div>\n                            </div>\n                            <div className=\"space-y-2\">\n                                {datasetMatches.map((match: DatasetEntry, idx: number) => (\n                                    <div\n                                        key={idx}\n                                        className=\"bg-black/50 border border-[var(--accent)]/30 rounded-lg p-3\"\n                                    >\n                                        <div className=\"text-sm text-white mb-1\">\n                                            \"{(match.message_text || match.message || match.text || '').substring(0, 100)}\"\n                                        </div>\n                                        <div className=\"flex items-center gap-3 text-xs\">\n                                            {match.toxicity_label && (\n                                                <span className=\"text-[var(--accent)]\">\n                                                    {match.toxicity_label}\n                                                </span>\n                                            )}\n                                            {match.crime_type && match.crime_type !== 'None' && (\n                                                <span className=\"text-orange-400\">\n                                                    {match.crime_type}\n                                                </span>\n                                            )}\n                                            {match.severity_level && match.severity_level !== 'None' && (\n                                                <span className=\"text-red-400\">\n                                                    Severity: {match.severity_level}\n                                                </span>\n                                            )}\n                                        </div>\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n                    )}\n\n                    {/* Summary */}\n                    <div className=\"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4\">\n                        <div className=\"flex items-start gap-2\">\n                            <AlertCircle className=\"w-5 h-5 text-blue-400 mt-0.5\" />\n                            <div className=\"flex-1\">\n                                <div className=\"text-sm font-medium text-blue-400 mb-1\">Summary</div>\n                                <div className=\"text-sm text-gray-300\">{analysisResult.analysis.summary}</div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"text-xs text-gray-500 text-center pt-2\">\n                        Results have been sent to the Investigation Assistant. Switch to the \"Active Investigation\" tab to view detailed recommendations.\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2247, "column": 0}, "map": {"version":3,"sources":["file:///Users/piyushraj/Desktop/CyberShieldX/Piyush/src/components/investigation/Assistant.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState } from 'react';\nimport { Severity } from '@/lib/crime/PatternDetector';\nimport {\n    ShieldAlert,\n    ShieldCheck,\n    AlertTriangle,\n    FileText,\n    CheckCircle2,\n    Circle,\n    ChevronDown,\n    ChevronUp,\n    Lock,\n    Smartphone,\n    EyeOff,\n    Ban\n} from 'lucide-react';\n\nexport interface LegalProvision {\n    act: string;\n    section: string;\n    description: string;\n}\n\nexport interface InvestigationStep {\n    id: string;\n    action: string;\n    description: string;\n    priority: Severity;\n}\n\nexport interface CrimeAnalysisResult {\n    detected: boolean;\n    categories: string[];\n    severity: Severity;\n    legalProvisions: LegalProvision[];\n    investigationSteps: InvestigationStep[];\n    matchedKeywords: string[];\n}\n\ninterface AssistantProps {\n    crimeAnalysis: CrimeAnalysisResult;\n}\n\nexport function InvestigationAssistant({ crimeAnalysis }: AssistantProps) {\n    const { severity, categories, investigationSteps, legalProvisions } = crimeAnalysis;\n    const [completedSteps, setCompletedSteps] = useState<string[]>([]);\n    const [safetyChecklist, setSafetyChecklist] = useState({\n        passwords: false,\n        twoFactor: false,\n        evidence: false,\n        blocking: false\n    });\n    const [isLegalExpanded, setIsLegalExpanded] = useState(false);\n\n    const toggleStep = (id: string) => {\n        setCompletedSteps(prev =>\n            prev.includes(id) ? prev.filter(stepId => stepId !== id) : [...prev, id]\n        );\n    };\n\n    const toggleSafetyItem = (key: keyof typeof safetyChecklist) => {\n        setSafetyChecklist(prev => ({ ...prev, [key]: !prev[key] }));\n    };\n\n    const getSeverityColor = (sev: Severity) => {\n        switch (sev) {\n            case Severity.CRITICAL: return 'bg-red-500 text-white';\n            case Severity.HIGH: return 'bg-orange-500 text-white';\n            case Severity.MEDIUM: return 'bg-yellow-500 text-white';\n            case Severity.LOW: return 'bg-blue-500 text-white';\n            default: return 'bg-gray-500 text-white';\n        }\n    };\n\n    const getSeverityBadgeColor = (sev: Severity) => {\n        switch (sev) {\n            case Severity.CRITICAL: return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300 border-red-200 dark:border-red-800';\n            case Severity.HIGH: return 'bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300 border-orange-200 dark:border-orange-800';\n            case Severity.MEDIUM: return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300 border-yellow-200 dark:border-yellow-800';\n            case Severity.LOW: return 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300 border-blue-200 dark:border-blue-800';\n            default: return 'bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300 border-gray-200 dark:border-gray-800';\n        }\n    };\n\n    const calculateProgress = () => {\n        const totalSafety = Object.keys(safetyChecklist).length;\n        const completeSafety = Object.values(safetyChecklist).filter(Boolean).length;\n\n        const totalInvest = investigationSteps.length;\n        const completeInvest = completedSteps.length;\n\n        if (totalSafety + totalInvest === 0) return 0;\n        return Math.round(((completeSafety + completeInvest) / (totalSafety + totalInvest)) * 100);\n    };\n\n    return (\n        <div className=\"w-full max-w-4xl mx-auto space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500\">\n            {/* Header Area */}\n            <div className=\"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-zinc-200 dark:border-zinc-800\">\n                <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                    <div>\n                        <div className=\"flex items-center gap-3 mb-2\">\n                            <h2 className=\"text-2xl font-bold text-zinc-900 dark:text-zinc-50\">Investigation Assistant</h2>\n                            <span className={`px-3 py-1 rounded-full text-sm font-medium border ${getSeverityBadgeColor(severity)}`}>\n                                {severity} Severity\n                            </span>\n                        </div>\n                        <p className=\"text-zinc-600 dark:text-zinc-400\">\n                            Detected: {categories.map(c => c).join(', ') || 'Processing...'}\n                        </p>\n                    </div>\n                    <div className=\"flex items-center gap-4 bg-zinc-50 dark:bg-zinc-950 p-4 rounded-xl border border-zinc-100 dark:border-zinc-800\">\n                        <div className=\"flex flex-col\">\n                            <span className=\"text-sm text-zinc-500 dark:text-zinc-400 font-medium\">Progress</span>\n                            <span className=\"text-2xl font-bold text-zinc-900 dark:text-zinc-50\">{calculateProgress()}%</span>\n                        </div>\n                        <div className=\"w-16 h-16 relative flex items-center justify-center\">\n                            <svg className=\"w-full h-full transform -rotate-90\">\n                                <circle\n                                    className=\"text-zinc-200 dark:text-zinc-800\"\n                                    strokeWidth=\"6\"\n                                    stroke=\"currentColor\"\n                                    fill=\"transparent\"\n                                    r=\"28\"\n                                    cx=\"32\"\n                                    cy=\"32\"\n                                />\n                                <circle\n                                    className=\"text-blue-600 dark:text-blue-500 transition-all duration-1000 ease-out\"\n                                    strokeWidth=\"6\"\n                                    strokeDasharray={175.93}\n                                    strokeDashoffset={175.93 - (calculateProgress() / 100) * 175.93}\n                                    strokeLinecap=\"round\"\n                                    stroke=\"currentColor\"\n                                    fill=\"transparent\"\n                                    r=\"28\"\n                                    cx=\"32\"\n                                    cy=\"32\"\n                                />\n                            </svg>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {/* Immediate Safety Checklist */}\n                <div className=\"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-zinc-200 dark:border-zinc-800\">\n                    <div className=\"flex items-center gap-2 mb-6\">\n                        <div className=\"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg text-red-600 dark:text-red-400\">\n                            <ShieldAlert className=\"w-5 h-5\" />\n                        </div>\n                        <h3 className=\"text-lg font-semibold text-zinc-900 dark:text-zinc-50\">Immediate Safety Actions</h3>\n                    </div>\n\n                    <div className=\"space-y-3\">\n                        <SafetyItem\n                            label=\"Change Passwords\"\n                            sublabel=\"Update passwords for all compromised accounts.\"\n                            icon={<Lock className=\"w-4 h-4\" />}\n                            checked={safetyChecklist.passwords}\n                            onChange={() => toggleSafetyItem('passwords')}\n                        />\n                        <SafetyItem\n                            label=\"Enable 2FA\"\n                            sublabel=\"Turn on Two-Factor Authentication immediately.\"\n                            icon={<Smartphone className=\"w-4 h-4\" />}\n                            checked={safetyChecklist.twoFactor}\n                            onChange={() => toggleSafetyItem('twoFactor')}\n                        />\n                        <SafetyItem\n                            label=\"Preserve Evidence\"\n                            sublabel=\"Do not delete messages. Take screenshots.\"\n                            icon={<EyeOff className=\"w-4 h-4\" />}\n                            checked={safetyChecklist.evidence}\n                            onChange={() => toggleSafetyItem('evidence')}\n                        />\n                        <SafetyItem\n                            label=\"Block Contacts\"\n                            sublabel=\"Block and report the perpetrator.\"\n                            icon={<Ban className=\"w-4 h-4\" />}\n                            checked={safetyChecklist.blocking}\n                            onChange={() => toggleSafetyItem('blocking')}\n                        />\n                    </div>\n                </div>\n\n                {/* Legal Guidance */}\n                <div className=\"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-zinc-200 dark:border-zinc-800 flex flex-col\">\n                    <div className=\"flex items-center gap-2 mb-6\">\n                        <div className=\"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg text-blue-600 dark:text-blue-400\">\n                            <FileText className=\"w-5 h-5\" />\n                        </div>\n                        <h3 className=\"text-lg font-semibold text-zinc-900 dark:text-zinc-50\">Legal Guidance</h3>\n                    </div>\n\n                    <div className=\"flex-1 overflow-y-auto pr-2 custom-scrollbar\">\n                        {legalProvisions.length > 0 ? (\n                            <div className=\"space-y-4\">\n                                {legalProvisions.map((provision, idx) => (\n                                    <div key={idx} className=\"p-4 rounded-xl bg-zinc-50 dark:bg-zinc-950 border border-zinc-100 dark:border-zinc-800\">\n                                        <div className=\"flex justify-between items-start mb-1\">\n                                            <span className=\"font-bold text-zinc-900 dark:text-zinc-50 text-sm\">{provision.act}</span>\n                                            <span className=\"text-xs font-mono bg-zinc-200 dark:bg-zinc-800 px-2 py-1 rounded text-zinc-600 dark:text-zinc-400\">{provision.section}</span>\n                                        </div>\n                                        <p className=\"text-sm text-zinc-600 dark:text-zinc-400 leading-relaxed\">\n                                            {provision.description}\n                                        </p>\n                                    </div>\n                                ))}\n                            </div>\n                        ) : (\n                            <div className=\"flex flex-col items-center justify-center h-full text-zinc-500 text-sm text-center\">\n                                <FileText className=\"w-8 h-8 mb-2 opacity-50\" />\n                                <p>No specific legal provisions detected yet.</p>\n                            </div>\n                        )}\n                    </div>\n                </div>\n            </div>\n\n            {/* Investigation Steps */}\n            <div className=\"bg-white dark:bg-zinc-900 rounded-2xl p-6 shadow-sm border border-zinc-200 dark:border-zinc-800\">\n                <div className=\"flex items-center gap-2 mb-6\">\n                    <div className=\"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg text-purple-600 dark:text-purple-400\">\n                        <ShieldCheck className=\"w-5 h-5\" />\n                    </div>\n                    <h3 className=\"text-lg font-semibold text-zinc-900 dark:text-zinc-50\">Recommended Actions</h3>\n                </div>\n\n                <div className=\"space-y-3\">\n                    {investigationSteps.length > 0 ? (\n                        investigationSteps.map((step) => (\n                            <div\n                                key={step.id}\n                                onClick={() => toggleStep(step.id)}\n                                className={`\n                                    group flex items-start gap-4 p-4 rounded-xl border transition-all cursor-pointer\n                                    ${completedSteps.includes(step.id)\n                                        ? 'bg-green-50/50 dark:bg-green-900/10 border-green-200 dark:border-green-800/50'\n                                        : 'bg-white dark:bg-zinc-900 hover:bg-zinc-50 dark:hover:bg-zinc-800/50 border-zinc-200 dark:border-zinc-800'\n                                    }\n                                `}\n                            >\n                                <div className={`mt-1 transition-colors ${completedSteps.includes(step.id) ? 'text-green-600 dark:text-green-500' : 'text-zinc-300 dark:text-zinc-700 group-hover:text-zinc-400'}`}>\n                                    {completedSteps.includes(step.id) ? (\n                                        <CheckCircle2 className=\"w-5 h-5\" />\n                                    ) : (\n                                        <Circle className=\"w-5 h-5\" />\n                                    )}\n                                </div>\n                                <div className=\"flex-1\">\n                                    <div className=\"flex items-center gap-2 mb-1\">\n                                        <h4 className={`font-medium ${completedSteps.includes(step.id) ? 'text-green-900 dark:text-green-100 line-through opacity-70' : 'text-zinc-900 dark:text-zinc-50'}`}>\n                                            {step.action}\n                                        </h4>\n                                        {step.priority === Severity.CRITICAL && (\n                                            <span className=\"text-[10px] font-bold uppercase tracking-wider bg-red-100 text-red-700 px-2 py-0.5 rounded-full dark:bg-red-900/50 dark:text-red-300\">\n                                                Critical\n                                            </span>\n                                        )}\n                                    </div>\n                                    <p className={`text-sm ${completedSteps.includes(step.id) ? 'text-green-700/70 dark:text-green-200/50' : 'text-zinc-500 dark:text-zinc-400'}`}>\n                                        {step.description}\n                                    </p>\n                                </div>\n                            </div>\n                        ))\n                    ) : (\n                        <p className=\"text-zinc-500 italic text-center py-8\">Action items will appear here based on the analysis.</p>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n}\n\nfunction SafetyItem({ label, sublabel, icon, checked, onChange }: {\n    label: string,\n    sublabel: string,\n    icon: React.ReactNode,\n    checked: boolean,\n    onChange: () => void\n}) {\n    return (\n        <div\n            onClick={onChange}\n            className={`\n                flex items-center gap-3 p-3 rounded-xl border cursor-pointer transition-all\n                ${checked\n                    ? 'bg-blue-50/50 dark:bg-blue-900/10 border-blue-200 dark:border-blue-800/50'\n                    : 'bg-zinc-50 dark:bg-zinc-950 hover:bg-zinc-100 dark:hover:bg-zinc-900 border-transparent'\n                }\n            `}\n        >\n            <div className={`p-2 rounded-lg ${checked ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'bg-white dark:bg-zinc-900 text-zinc-400 dark:text-zinc-600 shadow-sm'}`}>\n                {icon}\n            </div>\n            <div className=\"flex-1\">\n                <div className=\"flex items-center justify-between\">\n                    <p className={`font-medium text-sm ${checked ? 'text-blue-900 dark:text-blue-100' : 'text-zinc-900 dark:text-zinc-50'}`}>{label}</p>\n                    {checked && <CheckCircle2 className=\"w-4 h-4 text-blue-600 dark:text-blue-400\" />}\n                </div>\n                <p className={`text-xs ${checked ? 'text-blue-700/70 dark:text-blue-300/70' : 'text-zinc-500 dark:text-zinc-500'}`}>{sublabel}</p>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2922, "column": 0}, "map": {"version":3,"sources":["file:///Users/piyushraj/Desktop/CyberShieldX/Piyush/src/lib/pdf/ReportGenerator.ts"],"sourcesContent":["import { jsPDF } from 'jspdf';\nimport { ReportData } from '@/types';\n\nexport class ReportGenerator {\n    private doc: jsPDF;\n    private currentY: number;\n    private margin: number;\n    private pageWidth: number;\n\n    constructor() {\n        this.doc = new jsPDF();\n        this.currentY = 20;\n        this.margin = 20;\n        this.pageWidth = this.doc.internal.pageSize.width;\n    }\n\n    public async generate(data: ReportData): Promise<void> {\n        await this.buildDocument(data);\n        const filename = `CyberShieldX_Report_${data.id}_${new Date().toISOString().split('T')[0]}.pdf`;\n        this.doc.save(filename);\n    }\n\n    public async generateBuffer(data: ReportData): Promise<ArrayBuffer> {\n        await this.buildDocument(data);\n        return this.doc.output('arraybuffer');\n    }\n\n    private async buildDocument(data: ReportData): Promise<void> {\n        // 1. Header\n        this.addHeader(data);\n\n        // 2. Message Content\n        this.addMessageContent(data);\n\n        // 3. AI Analysis\n        this.addAIAnalysis(data);\n\n        // 4. Crime Pattern\n        this.addCrimePattern(data);\n\n        // 5. Investigation Steps\n        this.addInvestigationSteps(data);\n\n        // 6. Evidence Log\n        await this.addEvidenceLog(data);\n\n        // 7. Footer\n        this.addFooter(data);\n    }\n\n    private addHeader(data: ReportData) {\n        // Branding\n        this.doc.setFontSize(24);\n        this.doc.setTextColor(0, 102, 204); // Cyber Blue\n        this.doc.text('CyberShieldX', this.margin, this.currentY);\n\n        // Report ID and Date\n        this.doc.setFontSize(10);\n        this.doc.setTextColor(100, 100, 100);\n        this.doc.text(`Report ID: ${data.id}`, this.pageWidth - this.margin - 60, this.currentY);\n        this.doc.text(`Date: ${new Date(data.timestamp).toLocaleString()}`, this.pageWidth - this.margin - 60, this.currentY + 6);\n\n        this.currentY += 15;\n\n        // Line separator\n        this.doc.setDrawColor(200, 200, 200);\n        this.doc.line(this.margin, this.currentY, this.pageWidth - this.margin, this.currentY);\n        this.currentY += 15;\n\n        // Title & Severity\n        this.doc.setFontSize(16);\n        this.doc.setTextColor(0, 0, 0);\n        this.doc.text('Investigation Report', this.margin, this.currentY);\n\n        // Severity Badge (Simulated with colored rect and text)\n        const severityColor = this.getSeverityColor(data.severity);\n        this.doc.setFillColor(severityColor[0], severityColor[1], severityColor[2]);\n        this.doc.roundedRect(this.pageWidth - this.margin - 40, this.currentY - 6, 40, 10, 2, 2, 'F');\n\n        this.doc.setFontSize(10);\n        this.doc.setTextColor(255);\n        this.doc.text(data.severity.toUpperCase(), this.pageWidth - this.margin - 35, this.currentY + 1);\n\n        this.currentY += 15;\n    }\n\n    private addMessageContent(data: ReportData) {\n        this.checkPageBreak(40);\n\n        this.doc.setFontSize(12);\n        this.doc.setTextColor(50);\n        this.doc.setFont('helvetica', 'bold');\n        this.doc.text('1. Analyzed Content', this.margin, this.currentY);\n        this.currentY += 8;\n\n        this.doc.setFont('helvetica', 'normal');\n        this.doc.setFontSize(10);\n        this.doc.setTextColor(0);\n\n        // Message Box\n        this.doc.setFillColor(245, 247, 250);\n        this.doc.rect(this.margin, this.currentY, this.pageWidth - (this.margin * 2), 30, 'F');\n\n        const splitText = this.doc.splitTextToSize(data.message.content, this.pageWidth - (this.margin * 2) - 10);\n        this.doc.text(splitText, this.margin + 5, this.currentY + 7);\n\n        this.currentY += 35;\n\n        if (data.message.source) {\n            this.doc.setFontSize(9);\n            this.doc.setTextColor(100);\n            this.doc.text(`Source: ${data.message.source} | Sender: ${data.message.senderId || 'Unknown'}`, this.margin, this.currentY);\n            this.currentY += 10;\n        }\n    }\n\n    private addAIAnalysis(data: ReportData) {\n        this.checkPageBreak(60);\n\n        this.doc.setFontSize(12);\n        this.doc.setTextColor(50);\n        this.doc.setFont('helvetica', 'bold');\n        this.doc.text('2. AI Analysis', this.margin, this.currentY);\n        this.currentY += 10;\n\n        // Toxicity Score Bar\n        this.doc.setFontSize(10);\n        this.doc.setTextColor(0);\n        this.doc.setFont('helvetica', 'normal');\n        this.doc.text('Toxicity Score:', this.margin, this.currentY);\n\n        // Background bar\n        this.doc.setFillColor(230, 230, 230);\n        this.doc.rect(this.margin + 30, this.currentY - 4, 100, 5, 'F');\n\n        // Foreground bar\n        const score = data.analysis.toxicityScore;\n        const barColor = score > 70 ? [220, 38, 38] : score > 30 ? [245, 158, 11] : [16, 185, 129];\n        this.doc.setFillColor(barColor[0], barColor[1], barColor[2]);\n        this.doc.rect(this.margin + 30, this.currentY - 4, score, 5, 'F');\n\n        this.doc.text(`${score.toFixed(1)}%`, this.margin + 135, this.currentY);\n        this.currentY += 10;\n\n        // Keywords\n        this.doc.text('Detected Keywords:', this.margin, this.currentY);\n        const keywords = data.analysis.matchedKeywords.join(', ') || 'None';\n        this.doc.setTextColor(150, 0, 0);\n        this.doc.text(keywords, this.margin + 35, this.currentY);\n        this.currentY += 10;\n\n        // Confidence\n        this.doc.setTextColor(0, 0, 0);\n        this.doc.text(`Confidence: ${data.analysis.confidenceScore}%`, this.margin, this.currentY);\n        this.currentY += 15;\n    }\n\n    private addCrimePattern(data: ReportData) {\n        this.checkPageBreak(50);\n\n        this.doc.setFontSize(12);\n        this.doc.setTextColor(50);\n        this.doc.setFont('helvetica', 'bold');\n        this.doc.text('3. Crime Pattern Matches', this.margin, this.currentY);\n        this.currentY += 10;\n\n        if (data.crimePatterns.length === 0) {\n            this.doc.setFont('helvetica', 'normal');\n            this.doc.setFontSize(10);\n            this.doc.setTextColor(100, 100, 100);\n            this.doc.text('No specific crime patterns detected.', this.margin, this.currentY);\n            this.currentY += 10;\n            return;\n        }\n\n        data.crimePatterns.forEach(pattern => {\n            this.doc.setFont('helvetica', 'bold');\n            this.doc.setFontSize(11);\n            this.doc.setTextColor(0);\n            this.doc.text(pattern.category, this.margin, this.currentY);\n\n            this.doc.setFont('helvetica', 'normal');\n            this.doc.setFontSize(10);\n\n            // Legal Sections\n            if (pattern.legalReferences.length > 0) {\n                this.currentY += 5;\n                this.doc.text('Legal Violations:', this.margin + 5, this.currentY);\n                pattern.legalReferences.forEach(ref => {\n                    this.currentY += 5;\n                    this.doc.setTextColor(200, 0, 0);\n                    this.doc.text(`• ${ref.code} ${ref.section}: ${ref.description}`, this.margin + 10, this.currentY);\n                });\n            }\n            this.doc.setTextColor(0, 0, 0);\n            this.currentY += 10;\n        });\n    }\n\n    private addInvestigationSteps(data: ReportData) {\n        this.checkPageBreak(60);\n\n        this.doc.setFontSize(12);\n        this.doc.setTextColor(50);\n        this.doc.setFont('helvetica', 'bold');\n        this.doc.text('4. Recommended Investigation Steps', this.margin, this.currentY);\n        this.currentY += 10;\n\n        this.doc.setFont('helvetica', 'normal');\n        this.doc.setFontSize(10);\n        this.doc.setTextColor(0, 0, 0);\n\n        data.investigation.steps.forEach((step, index) => {\n            this.checkPageBreak(10);\n            const stepText = `${index + 1}. ${step}`;\n            const splitStep = this.doc.splitTextToSize(stepText, this.pageWidth - (this.margin * 2));\n            this.doc.text(splitStep, this.margin, this.currentY);\n            this.currentY += (splitStep.length * 5) + 3;\n        });\n\n        this.currentY += 5;\n    }\n\n    private async addEvidenceLog(data: ReportData) {\n        this.checkPageBreak(60);\n\n        this.doc.setFontSize(12);\n        this.doc.setTextColor(50);\n        this.doc.setFont('helvetica', 'bold');\n        this.doc.text('5. Evidence Log', this.margin, this.currentY);\n        this.currentY += 10;\n\n        if (data.evidence.length === 0) {\n            this.doc.setFont('helvetica', 'normal');\n            this.doc.setFontSize(10);\n            this.doc.text('No additional evidence attached.', this.margin, this.currentY);\n            this.currentY += 15;\n            return;\n        }\n\n        for (const item of data.evidence) {\n            this.checkPageBreak(40);\n            this.doc.setFont('helvetica', 'bold');\n            this.doc.setFontSize(10);\n            this.doc.text(`• ID: ${item.id} (${item.type})`, this.margin, this.currentY);\n            this.currentY += 5;\n\n            this.doc.setFont('helvetica', 'normal');\n            this.doc.setFontSize(9);\n            this.doc.text(`  Hash/Url: ${item.url.substring(0, 50)}...`, this.margin, this.currentY);\n            this.currentY += 5;\n\n            // If image, we could verify url and add it, but for now just logging validity\n            if (item.type === 'image') {\n                // Note: Adding images requires fetching the blob or base64. \n                // supporting remote URLs in jsPDF adds complexity (CORS).\n                // For this version, we list the link text. \n                // Future improvement: fetch and addImage\n                this.doc.setTextColor(0, 0, 255);\n                this.doc.textWithLink('Open Evidence', this.margin + 10, this.currentY, { url: item.url });\n                this.doc.setTextColor(0, 0, 0);\n                this.currentY += 5;\n            }\n\n            this.currentY += 5;\n        }\n    }\n\n    private addFooter(data: ReportData) {\n        // Position at bottom\n        const bottomY = this.doc.internal.pageSize.height - 20;\n\n        this.doc.setDrawColor(200);\n        this.doc.line(this.margin, bottomY - 5, this.pageWidth - this.margin, bottomY - 5);\n\n        this.doc.setFontSize(8);\n        this.doc.setTextColor(150);\n        this.doc.text('Generated by CyberShieldX | Official Investigation Report', this.margin, bottomY);\n        this.doc.text('This document is electronically generated and valid without signature.', this.margin, bottomY + 4);\n\n        // Watermark\n        this.doc.saveGraphicsState();\n        this.doc.setTextColor(230, 230, 230);\n        this.doc.setFontSize(60);\n        this.doc.text('CONFIDENTIAL', 40, 150, { angle: 45 });\n        this.doc.restoreGraphicsState();\n    }\n\n    private checkPageBreak(requiredSpace: number) {\n        if (this.currentY + requiredSpace > this.doc.internal.pageSize.height - this.margin) {\n            this.doc.addPage();\n            this.currentY = this.margin;\n        }\n    }\n\n    private getSeverityColor(severity: string): [number, number, number] {\n        switch (severity.toLowerCase()) {\n            case 'critical': return [220, 38, 38]; // Red\n            case 'high': return [249, 115, 22]; // Orange\n            case 'medium': return [234, 179, 8]; // Yellow\n            case 'low': return [34, 197, 94]; // Green\n            default: return [100, 116, 139]; // Gray\n        }\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAGO,MAAM;IACD,IAAW;IACX,SAAiB;IACjB,OAAe;IACf,UAAkB;IAE1B,aAAc;QACV,IAAI,CAAC,GAAG,GAAG,IAAI,wKAAK;QACpB,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK;IACrD;IAEA,MAAa,SAAS,IAAgB,EAAiB;QACnD,MAAM,IAAI,CAAC,aAAa,CAAC;QACzB,MAAM,WAAW,CAAC,oBAAoB,EAAE,KAAK,EAAE,CAAC,CAAC,EAAE,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC;QAC/F,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC;IAClB;IAEA,MAAa,eAAe,IAAgB,EAAwB;QAChE,MAAM,IAAI,CAAC,aAAa,CAAC;QACzB,OAAO,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC;IAC3B;IAEA,MAAc,cAAc,IAAgB,EAAiB;QACzD,YAAY;QACZ,IAAI,CAAC,SAAS,CAAC;QAEf,qBAAqB;QACrB,IAAI,CAAC,iBAAiB,CAAC;QAEvB,iBAAiB;QACjB,IAAI,CAAC,aAAa,CAAC;QAEnB,mBAAmB;QACnB,IAAI,CAAC,eAAe,CAAC;QAErB,yBAAyB;QACzB,IAAI,CAAC,qBAAqB,CAAC;QAE3B,kBAAkB;QAClB,MAAM,IAAI,CAAC,cAAc,CAAC;QAE1B,YAAY;QACZ,IAAI,CAAC,SAAS,CAAC;IACnB;IAEQ,UAAU,IAAgB,EAAE;QAChC,WAAW;QACX,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,KAAK,MAAM,aAAa;QACjD,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,gBAAgB,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;QAExD,qBAAqB;QACrB,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,KAAK;QAChC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,WAAW,EAAE,KAAK,EAAE,EAAE,EAAE,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,CAAC,QAAQ;QACvF,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,IAAI,KAAK,KAAK,SAAS,EAAE,cAAc,IAAI,EAAE,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,CAAC,QAAQ,GAAG;QAEvH,IAAI,CAAC,QAAQ,IAAI;QAEjB,iBAAiB;QACjB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,KAAK;QAChC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;QACrF,IAAI,CAAC,QAAQ,IAAI;QAEjB,mBAAmB;QACnB,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,GAAG;QAC5B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,wBAAwB,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;QAEhE,wDAAwD;QACxD,MAAM,gBAAgB,IAAI,CAAC,gBAAgB,CAAC,KAAK,QAAQ;QACzD,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,aAAa,CAAC,EAAE,EAAE,aAAa,CAAC,EAAE,EAAE,aAAa,CAAC,EAAE;QAC1E,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,CAAC,QAAQ,GAAG,GAAG,IAAI,IAAI,GAAG,GAAG;QAEzF,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;QACtB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,QAAQ,CAAC,WAAW,IAAI,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,CAAC,QAAQ,GAAG;QAE9F,IAAI,CAAC,QAAQ,IAAI;IACrB;IAEQ,kBAAkB,IAAgB,EAAE;QACxC,IAAI,CAAC,cAAc,CAAC;QAEpB,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;QACtB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;QAC9B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,uBAAuB,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;QAC/D,IAAI,CAAC,QAAQ,IAAI;QAEjB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;QAC9B,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;QAEtB,cAAc;QACd,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,KAAK;QAChC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,GAAI,IAAI,CAAC,MAAM,GAAG,GAAI,IAAI;QAElF,MAAM,YAAY,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,KAAK,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,GAAI,IAAI,CAAC,MAAM,GAAG,IAAK;QACtG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,IAAI,CAAC,MAAM,GAAG,GAAG,IAAI,CAAC,QAAQ,GAAG;QAE1D,IAAI,CAAC,QAAQ,IAAI;QAEjB,IAAI,KAAK,OAAO,CAAC,MAAM,EAAE;YACrB,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;YACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;YACtB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,KAAK,OAAO,CAAC,MAAM,CAAC,WAAW,EAAE,KAAK,OAAO,CAAC,QAAQ,IAAI,WAAW,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;YAC1H,IAAI,CAAC,QAAQ,IAAI;QACrB;IACJ;IAEQ,cAAc,IAAgB,EAAE;QACpC,IAAI,CAAC,cAAc,CAAC;QAEpB,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;QACtB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;QAC9B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;QAC1D,IAAI,CAAC,QAAQ,IAAI;QAEjB,qBAAqB;QACrB,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;QACtB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;QAC9B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,mBAAmB,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;QAE3D,iBAAiB;QACjB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,KAAK;QAChC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,CAAC,QAAQ,GAAG,GAAG,KAAK,GAAG;QAE3D,iBAAiB;QACjB,MAAM,QAAQ,KAAK,QAAQ,CAAC,aAAa;QACzC,MAAM,WAAW,QAAQ,KAAK;YAAC;YAAK;YAAI;SAAG,GAAG,QAAQ,KAAK;YAAC;YAAK;YAAK;SAAG,GAAG;YAAC;YAAI;YAAK;SAAI;QAC1F,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC,EAAE;QAC3D,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,CAAC,QAAQ,GAAG,GAAG,OAAO,GAAG;QAE7D,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,GAAG,KAAK,IAAI,CAAC,QAAQ;QACtE,IAAI,CAAC,QAAQ,IAAI;QAEjB,WAAW;QACX,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,sBAAsB,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;QAC9D,MAAM,WAAW,KAAK,QAAQ,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS;QAC7D,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,GAAG;QAC9B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,CAAC,QAAQ;QACvD,IAAI,CAAC,QAAQ,IAAI;QAEjB,aAAa;QACb,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,GAAG;QAC5B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,YAAY,EAAE,KAAK,QAAQ,CAAC,eAAe,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;QACzF,IAAI,CAAC,QAAQ,IAAI;IACrB;IAEQ,gBAAgB,IAAgB,EAAE;QACtC,IAAI,CAAC,cAAc,CAAC;QAEpB,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;QACtB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;QAC9B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,4BAA4B,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;QACpE,IAAI,CAAC,QAAQ,IAAI;QAEjB,IAAI,KAAK,aAAa,CAAC,MAAM,KAAK,GAAG;YACjC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;YAC9B,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;YACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,KAAK;YAChC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,wCAAwC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;YAChF,IAAI,CAAC,QAAQ,IAAI;YACjB;QACJ;QAEA,KAAK,aAAa,CAAC,OAAO,CAAC,CAAA;YACvB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;YAC9B,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;YACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;YACtB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;YAE1D,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;YAC9B,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;YAErB,iBAAiB;YACjB,IAAI,QAAQ,eAAe,CAAC,MAAM,GAAG,GAAG;gBACpC,IAAI,CAAC,QAAQ,IAAI;gBACjB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,qBAAqB,IAAI,CAAC,MAAM,GAAG,GAAG,IAAI,CAAC,QAAQ;gBACjE,QAAQ,eAAe,CAAC,OAAO,CAAC,CAAA;oBAC5B,IAAI,CAAC,QAAQ,IAAI;oBACjB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,GAAG;oBAC9B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,IAAI,IAAI,CAAC,CAAC,EAAE,IAAI,OAAO,CAAC,EAAE,EAAE,IAAI,WAAW,EAAE,EAAE,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,CAAC,QAAQ;gBACrG;YACJ;YACA,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,GAAG;YAC5B,IAAI,CAAC,QAAQ,IAAI;QACrB;IACJ;IAEQ,sBAAsB,IAAgB,EAAE;QAC5C,IAAI,CAAC,cAAc,CAAC;QAEpB,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;QACtB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;QAC9B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,sCAAsC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;QAC9E,IAAI,CAAC,QAAQ,IAAI;QAEjB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;QAC9B,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,GAAG;QAE5B,KAAK,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,MAAM;YACpC,IAAI,CAAC,cAAc,CAAC;YACpB,MAAM,WAAW,GAAG,QAAQ,EAAE,EAAE,EAAE,MAAM;YACxC,MAAM,YAAY,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,UAAU,IAAI,CAAC,SAAS,GAAI,IAAI,CAAC,MAAM,GAAG;YACrF,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;YACnD,IAAI,CAAC,QAAQ,IAAI,AAAC,UAAU,MAAM,GAAG,IAAK;QAC9C;QAEA,IAAI,CAAC,QAAQ,IAAI;IACrB;IAEA,MAAc,eAAe,IAAgB,EAAE;QAC3C,IAAI,CAAC,cAAc,CAAC;QAEpB,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;QACtB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;QAC9B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,mBAAmB,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;QAC3D,IAAI,CAAC,QAAQ,IAAI;QAEjB,IAAI,KAAK,QAAQ,CAAC,MAAM,KAAK,GAAG;YAC5B,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;YAC9B,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;YACrB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,oCAAoC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;YAC5E,IAAI,CAAC,QAAQ,IAAI;YACjB;QACJ;QAEA,KAAK,MAAM,QAAQ,KAAK,QAAQ,CAAE;YAC9B,IAAI,CAAC,cAAc,CAAC;YACpB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;YAC9B,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;YACrB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,KAAK,EAAE,CAAC,EAAE,EAAE,KAAK,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;YAC3E,IAAI,CAAC,QAAQ,IAAI;YAEjB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa;YAC9B,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;YACrB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,YAAY,EAAE,KAAK,GAAG,CAAC,SAAS,CAAC,GAAG,IAAI,GAAG,CAAC,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ;YACvF,IAAI,CAAC,QAAQ,IAAI;YAEjB,8EAA8E;YAC9E,IAAI,KAAK,IAAI,KAAK,SAAS;gBACvB,6DAA6D;gBAC7D,0DAA0D;gBAC1D,4CAA4C;gBAC5C,yCAAyC;gBACzC,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,GAAG;gBAC5B,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,iBAAiB,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,CAAC,QAAQ,EAAE;oBAAE,KAAK,KAAK,GAAG;gBAAC;gBACxF,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,GAAG;gBAC5B,IAAI,CAAC,QAAQ,IAAI;YACrB;YAEA,IAAI,CAAC,QAAQ,IAAI;QACrB;IACJ;IAEQ,UAAU,IAAgB,EAAE;QAChC,qBAAqB;QACrB,MAAM,UAAU,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG;QAEpD,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;QACtB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,UAAU,GAAG,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,EAAE,UAAU;QAEhF,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;QACtB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,6DAA6D,IAAI,CAAC,MAAM,EAAE;QACxF,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,0EAA0E,IAAI,CAAC,MAAM,EAAE,UAAU;QAE/G,YAAY;QACZ,IAAI,CAAC,GAAG,CAAC,iBAAiB;QAC1B,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,KAAK;QAChC,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;QACrB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,gBAAgB,IAAI,KAAK;YAAE,OAAO;QAAG;QACnD,IAAI,CAAC,GAAG,CAAC,oBAAoB;IACjC;IAEQ,eAAe,aAAqB,EAAE;QAC1C,IAAI,IAAI,CAAC,QAAQ,GAAG,gBAAgB,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,EAAE;YACjF,IAAI,CAAC,GAAG,CAAC,OAAO;YAChB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM;QAC/B;IACJ;IAEQ,iBAAiB,QAAgB,EAA4B;QACjE,OAAQ,SAAS,WAAW;YACxB,KAAK;gBAAY,OAAO;oBAAC;oBAAK;oBAAI;iBAAG,EAAE,MAAM;YAC7C,KAAK;gBAAQ,OAAO;oBAAC;oBAAK;oBAAK;iBAAG,EAAE,SAAS;YAC7C,KAAK;gBAAU,OAAO;oBAAC;oBAAK;oBAAK;iBAAE,EAAE,SAAS;YAC9C,KAAK;gBAAO,OAAO;oBAAC;oBAAI;oBAAK;iBAAG,EAAE,QAAQ;YAC1C;gBAAS,OAAO;oBAAC;oBAAK;oBAAK;iBAAI,EAAE,OAAO;QAC5C;IACJ;AACJ"}},
    {"offset": {"line": 3224, "column": 0}, "map": {"version":3,"sources":["file:///Users/piyushraj/Desktop/CyberShieldX/Piyush/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport { FileSearch, ShieldAlert, FileText, Menu, X } from 'lucide-react';\nimport AnimatedText from '@/components/ui/AnimatedText';\nimport ScrollReveal from '@/components/ui/ScrollReveal';\nimport OCRAnalyzer from '@/components/evidence/OCRAnalyzer';\nimport TextAnalyzer from '@/components/evidence/TextAnalyzer';\nimport { InvestigationAssistant } from '@/components/investigation/Assistant';\nimport { MessageAnalyzer } from '@/lib/analyzer/MessageAnalyzer';\nimport { PatternDetector, CrimeMatch, Severity } from '@/lib/crime/PatternDetector';\nimport { ReportGenerator } from '@/lib/pdf/ReportGenerator';\nimport { AnalysisResult } from '@/lib/analyzer/MessageAnalyzer';\nimport { ReportData, CaseSeverity, Evidence } from '@/types';\nimport { v4 as uuidv4 } from 'uuid';\n\nexport default function Home() {\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const [evidenceMode, setEvidenceMode] = useState<'ocr' | 'text'>('text');\n\n  // Investigation state\n  const [currentAnalysis, setCurrentAnalysis] = useState<AnalysisResult | null>(null);\n  const [currentPatterns, setCurrentPatterns] = useState<CrimeMatch[]>([]);\n  const [currentEvidence, setCurrentEvidence] = useState<Evidence[]>([]);\n  const [analyzedText, setAnalyzedText] = useState<string>('');\n  const [caseSeverity, setCaseSeverity] = useState<CaseSeverity>(Severity.LOW);\n\n  const [analyzer] = useState(() => new MessageAnalyzer());\n  const [detector] = useState(() => new PatternDetector());\n  const [reportGenerator] = useState(() => new ReportGenerator());\n\n  const handleEvidenceProcessed = async (text: string, evidenceItems: Evidence[]) => {\n    setAnalyzedText(text);\n    setCurrentEvidence(prev => [...prev, ...evidenceItems]);\n\n    const analysis = await analyzer.analyze(text);\n    setCurrentAnalysis(analysis);\n\n    const patterns = detector.detect(text);\n    setCurrentPatterns(patterns);\n\n    const maxSeverity = patterns.length > 0\n      ? patterns[0].severity\n      : (analysis.toxicityScore > 80 ? 'High' : 'Low');\n\n    setCaseSeverity(maxSeverity as CaseSeverity);\n\n    // Smooth scroll to investigation\n    document.getElementById('investigation')?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const handleGenerateReport = async () => {\n    if (!currentAnalysis) return;\n\n    const reportData: ReportData = {\n      id: uuidv4(),\n      timestamp: new Date().toISOString(),\n      severity: caseSeverity,\n      message: {\n        content: analyzedText,\n        source: 'Evidence Analysis',\n        senderId: 'Unknown'\n      },\n      analysis: currentAnalysis,\n      crimePatterns: currentPatterns,\n      investigation: {\n        steps: currentPatterns.flatMap(p => p.investigationSteps.map(s => s.action)),\n        evidenceCollected: currentEvidence.map(e => e.filename)\n      },\n      evidence: currentEvidence,\n      agent: {\n        name: 'Analyst User',\n        id: 'user-1'\n      }\n    };\n\n    await reportGenerator.generate(reportData);\n  };\n\n  const scrollToSection = (id: string) => {\n    document.getElementById(id)?.scrollIntoView({ behavior: 'smooth' });\n    setMobileMenuOpen(false);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-black text-white\">\n      {/* Fixed Header */}\n      <header className=\"fixed top-0 left-0 right-0 z-50 bg-black/80 backdrop-blur-md border-b border-white/10\">\n        <nav className=\"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between\">\n          {/* Logo */}\n          <div className=\"flex items-center gap-2 text-[var(--accent)] font-bold text-xl tracking-wider\">\n            <ShieldAlert className=\"w-6 h-6\" />\n            <span>CYBERSHIELD</span>\n          </div>\n\n          {/* Desktop Navigation */}\n          <div className=\"hidden md:flex items-center gap-8\">\n            <button onClick={() => scrollToSection('hero')} className=\"text-sm font-medium hover:text-[var(--accent)] transition-colors tracking-wide\">\n              HOME\n            </button>\n            <button onClick={() => scrollToSection('evidence')} className=\"text-sm font-medium hover:text-[var(--accent)] transition-colors tracking-wide\">\n              EVIDENCE LAB\n            </button>\n            <button onClick={() => scrollToSection('investigation')} className=\"text-sm font-medium hover:text-[var(--accent)] transition-colors tracking-wide\">\n              INVESTIGATION\n            </button>\n            <button onClick={() => scrollToSection('technology')} className=\"text-sm font-medium hover:text-[var(--accent)] transition-colors tracking-wide\">\n              TECHNOLOGY\n            </button>\n            <a href=\"/dataset\" className=\"text-sm font-medium hover:text-[var(--accent)] transition-colors tracking-wide\">\n              DATASET\n            </a>\n          </div>\n\n          {/* Mobile Menu Button */}\n          <button\n            onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n            className=\"md:hidden p-2 hover:bg-white/5 rounded\"\n          >\n            {mobileMenuOpen ? <X className=\"w-6 h-6\" /> : <Menu className=\"w-6 h-6\" />}\n          </button>\n        </nav>\n\n        {/* Mobile Menu */}\n        {mobileMenuOpen && (\n          <div className=\"md:hidden bg-black border-t border-white/10\">\n            <div className=\"px-6 py-4 space-y-4\">\n              <button onClick={() => scrollToSection('hero')} className=\"block w-full text-left text-sm font-medium hover:text-[var(--accent)] transition-colors tracking-wide\">\n                HOME\n              </button>\n              <button onClick={() => scrollToSection('evidence')} className=\"block w-full text-left text-sm font-medium hover:text-[var(--accent)] transition-colors tracking-wide\">\n                EVIDENCE LAB\n              </button>\n              <button onClick={() => scrollToSection('investigation')} className=\"block w-full text-left text-sm font-medium hover:text-[var(--accent)] transition-colors tracking-wide\">\n                INVESTIGATION\n              </button>\n              <button onClick={() => scrollToSection('technology')} className=\"block w-full text-left text-sm font-medium hover:text-[var(--accent)] transition-colors tracking-wide\">\n                TECHNOLOGY\n              </button>\n            </div>\n          </div>\n        )}\n      </header>\n\n      {/* Hero Section */}\n      <section id=\"hero\" className=\"min-h-screen flex items-center justify-center px-6 pt-20\">\n        <div className=\"max-w-5xl mx-auto text-center\">\n          <AnimatedText\n            text=\"AI-POWERED THREAT DETECTION\"\n            className=\"text-5xl md:text-7xl font-bold mb-6 tracking-tight\"\n            speed={30}\n          />\n          <ScrollReveal delay={1500}>\n            <p className=\"text-xl md:text-2xl text-[var(--text-secondary)] mb-12 max-w-3xl mx-auto leading-relaxed\">\n              Advanced cyberbullying detection and cybercrime investigation platform powered by artificial intelligence\n            </p>\n          </ScrollReveal>\n          <ScrollReveal delay={2000}>\n            <button\n              onClick={() => scrollToSection('evidence')}\n              className=\"px-8 py-4 border-2 border-[var(--accent)] text-[var(--accent)] font-bold tracking-wider hover:bg-[var(--accent)] hover:text-black transition-all duration-300 text-sm\"\n            >\n              [ START ANALYSIS ]\n            </button>\n          </ScrollReveal>\n        </div>\n      </section>\n\n      {/* Evidence Lab Section */}\n      <section id=\"evidence\" className=\"min-h-screen py-20 px-6 bg-[var(--bg-secondary)]\">\n        <div className=\"max-w-6xl mx-auto\">\n          <ScrollReveal>\n            <h2 className=\"text-4xl md:text-5xl font-bold mb-4 tracking-tight\">EVIDENCE LAB</h2>\n            <p className=\"text-xl text-[var(--text-secondary)] mb-12\">\n              Analyze text and images for potential threats\n            </p>\n          </ScrollReveal>\n\n          <ScrollReveal delay={200}>\n            <div className=\"flex items-center gap-2 bg-black border border-white/10 rounded-lg p-1 w-fit mb-8\">\n              <button\n                onClick={() => setEvidenceMode('text')}\n                className={`px-6 py-3 rounded-md text-sm font-bold transition-all tracking-wide ${evidenceMode === 'text'\n                  ? 'bg-[var(--accent)] text-black'\n                  : 'text-[var(--text-secondary)] hover:text-white'\n                  }`}\n              >\n                TEXT INPUT\n              </button>\n              <button\n                onClick={() => setEvidenceMode('ocr')}\n                className={`px-6 py-3 rounded-md text-sm font-bold transition-all tracking-wide ${evidenceMode === 'ocr'\n                  ? 'bg-[var(--accent)] text-black'\n                  : 'text-[var(--text-secondary)] hover:text-white'\n                  }`}\n              >\n                IMAGE OCR\n              </button>\n            </div>\n          </ScrollReveal>\n\n          <ScrollReveal delay={400}>\n            {evidenceMode === 'text' ? (\n              <TextAnalyzer onAnalysisComplete={handleEvidenceProcessed} />\n            ) : (\n              <OCRAnalyzer onAnalysisComplete={handleEvidenceProcessed} />\n            )}\n          </ScrollReveal>\n        </div>\n      </section>\n\n      {/* Investigation Section */}\n      <section id=\"investigation\" className=\"min-h-screen py-20 px-6\">\n        <div className=\"max-w-6xl mx-auto\">\n          <ScrollReveal>\n            <div className=\"flex items-center justify-between mb-12\">\n              <div>\n                <h2 className=\"text-4xl md:text-5xl font-bold mb-4 tracking-tight\">ACTIVE INVESTIGATION</h2>\n                <p className=\"text-xl text-[var(--text-secondary)]\">\n                  AI-powered case analysis and recommendations\n                </p>\n              </div>\n              {currentAnalysis && (\n                <button\n                  onClick={handleGenerateReport}\n                  className=\"px-6 py-3 border-2 border-[var(--accent)] text-[var(--accent)] font-bold tracking-wider hover:bg-[var(--accent)] hover:text-black transition-all duration-300 text-sm flex items-center gap-2\"\n                >\n                  <FileText className=\"w-4 h-4\" />\n                  [ GENERATE REPORT ]\n                </button>\n              )}\n            </div>\n          </ScrollReveal>\n\n          <ScrollReveal delay={200}>\n            {!currentAnalysis ? (\n              <div className=\"flex flex-col items-center justify-center h-96 border border-dashed border-white/10 rounded-lg\">\n                <FileSearch className=\"w-16 h-16 mb-4 opacity-20\" />\n                <h3 className=\"text-2xl font-bold text-[var(--text-secondary)] mb-2\">NO ACTIVE CASE</h3>\n                <p className=\"text-[var(--text-tertiary)]\">\n                  Upload evidence in the <button onClick={() => scrollToSection('evidence')} className=\"text-[var(--accent)] hover:underline\">Evidence Lab</button> to start\n                </p>\n              </div>\n            ) : (\n              <div className=\"space-y-8\">\n                {/* Case Summary */}\n                <div className=\"bg-[var(--bg-card)] border border-white/10 rounded-lg p-8\">\n                  <h3 className=\"text-[var(--accent)] font-mono text-sm mb-6 tracking-wider\">CASE_SUMMARY_V1</h3>\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n                    <div>\n                      <span className=\"text-xs text-[var(--text-tertiary)] uppercase tracking-wider\">Analysis Confidence</span>\n                      <div className=\"text-4xl font-bold text-white mt-2\">{currentAnalysis.confidenceScore}%</div>\n                    </div>\n                    <div>\n                      <span className=\"text-xs text-[var(--text-tertiary)] uppercase tracking-wider\">Detected Patterns</span>\n                      <div className=\"text-4xl font-bold text-white mt-2\">{currentPatterns.length}</div>\n                    </div>\n                    <div>\n                      <span className=\"text-xs text-[var(--text-tertiary)] uppercase tracking-wider\">Main Category</span>\n                      <div className=\"text-4xl font-bold text-white mt-2\">{currentPatterns[0]?.category || currentAnalysis.category}</div>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Investigation Assistant */}\n                <InvestigationAssistant\n                  crimeAnalysis={{\n                    detected: currentPatterns.length > 0 || currentAnalysis.toxicityScore > 50,\n                    categories: currentPatterns.map(p => p.category),\n                    severity: caseSeverity as unknown as Severity,\n                    legalProvisions: currentPatterns.flatMap(p => p.legalReferences.map(r => ({ act: r.code, section: r.section, description: r.description }))),\n                    investigationSteps: currentPatterns.flatMap(p => p.investigationSteps.map(s => ({\n                      id: s.id,\n                      action: s.action,\n                      description: s.description,\n                      priority: caseSeverity as unknown as Severity\n                    }))),\n                    matchedKeywords: currentAnalysis.matchedKeywords\n                  }}\n                />\n              </div>\n            )}\n          </ScrollReveal>\n        </div>\n      </section>\n\n      {/* Technology Section */}\n      <section id=\"technology\" className=\"min-h-screen py-20 px-6 bg-[var(--bg-secondary)]\">\n        <div className=\"max-w-6xl mx-auto\">\n          <ScrollReveal>\n            <h2 className=\"text-4xl md:text-5xl font-bold mb-4 tracking-tight\">HOW IT WORKS</h2>\n            <p className=\"text-xl text-[var(--text-secondary)] mb-16\">\n              Three-phase AI-powered analysis system\n            </p>\n          </ScrollReveal>\n\n          <div className=\"space-y-16\">\n            {/* Phase 1 */}\n            <ScrollReveal delay={200}>\n              <div className=\"flex items-start gap-8\">\n                <div className=\"text-6xl font-bold text-[var(--accent)] opacity-20\">01</div>\n                <div className=\"flex-1\">\n                  <h3 className=\"text-2xl font-bold mb-4\">ANALYZE</h3>\n                  <p className=\"text-[var(--text-secondary)] leading-relaxed\">\n                    Advanced NLP algorithms scan text for toxicity, threats, harassment patterns, and fraud indicators. Our AI analyzes sentiment, context, and linguistic patterns to detect potential cybercrime.\n                  </p>\n                </div>\n              </div>\n              <div className=\"h-px bg-white/10 my-8\"></div>\n            </ScrollReveal>\n\n            {/* Phase 2 */}\n            <ScrollReveal delay={400}>\n              <div className=\"flex items-start gap-8\">\n                <div className=\"text-6xl font-bold text-[var(--accent)] opacity-20\">02</div>\n                <div className=\"flex-1\">\n                  <h3 className=\"text-2xl font-bold mb-4\">DETECT</h3>\n                  <p className=\"text-[var(--text-secondary)] leading-relaxed\">\n                    Pattern detection engine matches content against known crime categories including extortion, harassment, threats, fraud, identity theft, and child exploitation. Maps violations to legal frameworks (IT Act, IPC).\n                  </p>\n                </div>\n              </div>\n              <div className=\"h-px bg-white/10 my-8\"></div>\n            </ScrollReveal>\n\n            {/* Phase 3 */}\n            <ScrollReveal delay={600}>\n              <div className=\"flex items-start gap-8\">\n                <div className=\"text-6xl font-bold text-[var(--accent)] opacity-20\">03</div>\n                <div className=\"flex-1\">\n                  <h3 className=\"text-2xl font-bold mb-4\">REPORT</h3>\n                  <p className=\"text-[var(--text-secondary)] leading-relaxed\">\n                    Generates comprehensive investigation reports with legal references, recommended actions, evidence logs, and safety measures. Exports professional PDF documentation for law enforcement and legal proceedings.\n                  </p>\n                </div>\n              </div>\n            </ScrollReveal>\n          </div>\n        </div>\n      </section>\n\n      {/* Footer */}\n      <footer className=\"py-12 px-6 border-t border-white/10\">\n        <div className=\"max-w-6xl mx-auto\">\n          <div className=\"flex flex-col md:flex-row items-center justify-between gap-6\">\n            <div className=\"flex items-center gap-2 text-[var(--accent)] font-bold text-lg tracking-wider\">\n              <ShieldAlert className=\"w-5 h-5\" />\n              <span>CYBERSHIELD</span>\n            </div>\n            <div className=\"flex items-center gap-8 text-sm text-[var(--text-tertiary)]\">\n              <button onClick={() => scrollToSection('hero')} className=\"hover:text-white transition-colors\">HOME</button>\n              <button onClick={() => scrollToSection('evidence')} className=\"hover:text-white transition-colors\">EVIDENCE LAB</button>\n              <button onClick={() => scrollToSection('investigation')} className=\"hover:text-white transition-colors\">INVESTIGATION</button>\n              <button onClick={() => scrollToSection('technology')} className=\"hover:text-white transition-colors\">TECHNOLOGY</button>\n            </div>\n          </div>\n          <div className=\"text-center mt-8 text-sm text-[var(--text-tertiary)]\">\n            © 2026 CyberShield. AI-Powered Threat Detection Platform.\n          </div>\n        </div>\n      </footer>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}